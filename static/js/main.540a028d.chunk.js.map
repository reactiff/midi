{"version":3,"sources":["../../src/midiContext.ts","../../src/initialize/frequencyMap.ts","../../src/initialize/processMidiMessage.ts","../../src/initialize/DeviceController.tsx","../../src/initialize/index.ts","../../src/initialize/requestMidiDevices.ts","../../node_modules/@reactiff/ui-core/dist/index.modern.js","../../src/Settings/MIDIPad.tsx","../../src/Settings/MIDISelector.tsx","../../src/Settings/index.tsx","../../src/MidiIndicator.tsx","../../src/Midi.tsx","Layout.tsx","PropsTable.tsx","MidiControlledComponent.tsx","App.tsx","index.tsx"],"names":["midiContext","register","unregister","frequencyMap","Array","length","note","res","i","A_FREQ","event","command","velocity","frequency","handlerName","group","name","type","channel","change","getStorageKey","controller","layout","eventTarget","Object","DeviceController","enabled","connected","sustained","initialized","midiMap","fromMidi","fromControl","device","this","uuid","onMIDIMessage","bind","bindEventTarget","key","blob","localStorage","object","JSON","rev","loadMappings","beginMapping","rerender","activeMapping","cancelMapping","finalizeMapping","message","controlId","props","getControlId","rev1","saveMappings","getMappedEventData","disconnect","eventId","mapping","fn","processMidiMessage","enable","items","d","initialize","onStateChange","found","changes","newList","c","e","newState","console","Promise","navi","devices","midiAccess","resolve","detectedDevices","_extends","assign","target","arguments","source","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","_arrayLikeToArray","arr","len","arr2","_createForOfIteratorHelperLoose","o","allowArrayLike","it","Symbol","iterator","next","isArray","minLen","n","toString","slice","constructor","from","test","_unsupportedIterableToArray","done","value","TypeError","fnOrValue","element","param","rootKey","defaultValue","matchSingleKey","matchKey","some","_len","pairs","_key","range","Error","_ref","start","end","undefined","Math","max","min","step","j","k","strutil","camelToSentenceCase","string","replace","trim","split","filter","t","map","token","trimmed","toUpperCase","substring","join","camelToKebabCase","toLowerCase","toProperCase","mutateWhile","original","condition","transform","result","toCamelCase","temp","removeDoubleSpaces","s","replaceAll","array","all","x","uniques","Set","sortBy","valueForItem","order","dir","a","b","sortByDesc","toDictionary","reduce","dict","item","_Object$assign","date","parse","offsetMinutes","Date","getTimezoneOffset","minutes","adjustmentTime","padStart","_yyyymmdd$split","yyyy","MM","dd","isoToInt","isoDate","_isoDate$split$0$spli","parseInt","_excluded","_excluded2","traverseLeaf","ctx","debug","log","depth","fill","results","cbContext","contructorName","path","tokens","find","select","visit","concat","expand","other","index","traverseArray","isNullOrUndefined","_i","_Object$keys","symbols","getOwnPropertySymbols","_step","_iterator","symbol","traverseObject","traverse","strategy","ns","Reflect","has","namespace","assignPath","cursor","node","_sum","args","acc","aggregate","elem","itemValue","fnConcat","MapReduceObject","_proto","count","_this","entries","Number","MAX_VALUE","MIN_VALUE","sum","avg","values","util","logic","selectShape","shape","alias","selector","sourcePath","get","intersect","mapReduce","obj","useStyles","makeStyles","root","maxWidth","media","height","style","dependencies","createStyles","cols","createElement","className","toFixed","attributeMap","bgColor","classMap","scrollableX","scrollableY","borderBox","createStyle","bag","resolvedKey","hex","getOrMakeStyle","createClass","resolvedClass","classes","push","switches","absolute","alignStart","alignCenter","alignEnd","alignStretch","alignBaseline","alignAuto","alignSelfStart","alignSelfCenter","alignSelfEnd","alignSelfStretch","alignSelfBaseline","anchorBottom","anchorLeft","anchorRight","anchorTop","beveled","block","centerX","centerXY","centerY","clickable","coverImage","fixed","fullWidth","fullWidthAlways","grow","hidden","horizontal","inline","inlineBlock","justifyStart","justifyCenter","justifyEnd","mobileCenter","mobileColumn","mobileOnly","noBr","noBreak","noMargin","noMobile","noOverflow","noPadding","noSelect","noTransform","noWrap","opaque","overlay","relative","round","rounded","scrollable","shrink","small","smaller","solid","spaced","sticky","tall","translucent","vertical","wide","styleAttributes","backgroundColor","backgroundImage","backgroundRepeat","backgroundPosition","backgroundSize","border","borderTop","borderRight","borderBottom","borderLeft","borderRadius","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","color","dataProps","fontSize","fontStyle","fontWeight","innerProps","lineHeight","margin","marginTop","marginRight","marginBottom","marginLeft","minHeight","minWidth","opacity","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","pseudo","textAlign","textTransform","title","width","top","right","bottom","left","_excluded$1","_excluded2$1","useStyleDirectives","directives","ownProps","tagName","id","children","ref","data","css","onBlur","onClick","onChange","onFocus","onMouseUp","onMouseDown","onMouseMove","ignoredProps","utilizedKeys","forEach","pseudoStyles","fullKey","usedStyles","events","attr","baseClasses","_excluded$2","_excluded2$2","_excluded3","_useStyleDirectives","_useStyleDirectives2","_useStyleDirectives3","divRowCol","__proto__","div","row","col","defaultProps","angle","BoxShadowDefaults","xOffset","yOffset","blur","spread","rgba","r","g","isClient","window","gridSizeValues","xs","sm","md","lg","xl","xxl","xxxl","breakpointSystem","bootstrap","material","getGridSize","system","innerWidth","makeGridSizeResult","code","getWindowHeight","innerHeight","getScrollPosition","document","body","scrollTop","documentElement","windowEventHandler","setState","readValue","compare","handleEvent","ticking","requestAnimationFrame","addEventListener","removeEventListener","hooks","createStripes","options","params","colors","parts","colorFromString","steps","total","colorCount","outSegments","distance","nextIndex","size","generateStripesStyle","createLinearGradient","_color$percentage","percentage","parseColor$1","repeat","tuple","generateLinearGradientStyle","useBoxShadow","useState","colorString","inset","useGridSize","current","_useState","state","gridSize","useWindowHeight","_useState2","useScrollPosition","_useState4","format","paragraphLowerBound","paragraphUpperBound","sentenceLowerBound","sentenceUpperBound","suffix","units","loremIpsum","words","dictionary","sentences","paragraphs","_excluded$3","_excluded2$3","colSpan","image","gridColumnEnd","description","_onClick","Paper","forwardRef","Slide","direction","isString","isUndefined","isNull","isNullOrUndefined$1","validation","isNumber","isJsonPath","Throttle","lastKnownParams","invokeWithAnimationFrame","method","_ownProps","stickyTop","ui$1","_ownProps$1","page","tight","header","panel","_excluded$4","TabPanel","active","role","_excluded$5","card","footerActions","Card","CardActionArea","CardMedia","url","CardContent","Typography","gutterBottom","variant","component","CardActions","Button","clsx","counter","useRef","position","zIndex","drawer","_React$useState","open","setOpen","_React$useState2","closed","setClosed","externallyControlled","drawerOpen","toggleDrawer","onOpen","onClose","Fragment","button","cloneElement","Drawer","anchor","dropdown","localStorageKey","label","labelId","v4","getItem","selectedValue","setSelectedValue","auxOptions","option","text","aux","FormControl","InputLabel","Select","setItem","MenuItem","masonry","elementForItem","revision","theme","useTheme","mutable","resizing","gridItems","getElementsByClassName","_useMemo","grid","rowHeight","getComputedStyle","getPropertyValue","rowGap","innerElement","querySelector","heightRatio","getAttribute","container","resizeGridItem","useCallback","gi","rect","getBoundingClientRect","rowSpan","heightWithGap","remainder","_heightWithGap","_remainder","gridRowEnd","resizeAllGridItems","handleResizeAllGridItems","timer","setTimeout","clearTimeout","inline$1","gridTemplateColumns","boxShadow","palette","overflow","modal","handleClose","handleEscapeKey","onEscape","Dialog","show","TransitionComponent","disableBackdropClick","disableEscapeKeyDown","DialogActions","onOk","numberInput","throttle","inputRef","buffer","setBuffer","constraints","precision","unsigned","context","handleChange","parsedValue","parseFloat","newValue","lib","math","roundDecimal","handleFocus","handleBlur","innerValue","ui","Flex","alignItems","sliderInput","inputMode","pattern","required","placeholder","inputWithUpDown","propertyPage","table","cellPadding","cellSpacing","itemIndex","tabs","activeKey","keyForItem","selectedKey","setActiveKey","internalStyle","tabStrip","Tabs","orientation","Tab","tabContent","isActiveTab","verticalLayout","horizontalLayout","isVertical","useInlineStyle","isActive","setRevision","mappedControl","mapped","cssBase","cssKnob","borderColor","React","MidiSettings","midi","quitNow","onEscapeKey","useEffect","cssBG","cssDialog","eventHandler","config","horizontalInverted","verticalInverted","VerticalGlobals","scope","channelNumbers","channelControls","HorizontalGlobals","VerticalLayout","control","HorizontalLayout","MidiIndicator","controllers","setControllers","settingsOpen","setSettingsOpen","targetMap","targetStack","bindEventTargets","cc","_t","tgt","toggleSettings","getEventTarget","MidiControlledComponent","href","src","alt","PropsTable","properties","p","channels","globalGroups","useContext","touchState","setTouchState","paramState","setParamState","updateTouchState","updateParamState","useMemo","onTouchStart","onAfterTouch","onTouchEnd","onParameterChange","createEventHandler","keyCount","hasKeys","App","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.540a028d.chunk.js","sourcesContent":["import React from 'react';\r\nimport DeviceController from './initialize/DeviceController';\r\nimport { MidiEventTarget, MidiControl } from './initialize/processMidiMessage';\r\n\r\nexport type MidiMappedEvent = { \r\n    command: number, \r\n    note: number \r\n};\r\n\r\nexport type MidiMappedControl = { \r\n    channel: number,\r\n    control: MidiControl,\r\n    controller: DeviceController,\r\n    rerender: () => void,\r\n};\r\n\r\n\r\nexport type MidiContext = {\r\n    register: (target: MidiEventTarget) => void, \r\n    unregister: (target: MidiEventTarget) => void, \r\n};\r\n\r\n\r\nexport interface InternalMidiContextInterface {\r\n\r\n    settingsOpen: boolean;\r\n    toggleSettings: (open: boolean) => void;\r\n\r\n    controllers: DeviceController[];\r\n    setControllers: (controllers: DeviceController[]) => void;\r\n\r\n    getEventTarget: () => MidiEventTarget | undefined; \r\n\r\n    register: (target: MidiEventTarget) => void;\r\n    unregister: (target: MidiEventTarget) => void;\r\n\r\n};\r\n\r\nconst midiContext = React.createContext<MidiContext>({\r\n    register: () => {},\r\n    unregister: () => {},\r\n});\r\n    \r\nexport default midiContext;","const A_FREQ = 440;\r\nfunction calculateNoteFrequency(note: number) {\r\n  return (A_FREQ / 32) * (2 ** ((note - 9) / 12))\r\n}\r\ntype FrequencyMap = { [index: number]: number };\r\n\r\nconst frequencyMap: FrequencyMap = Array.from({length: 88})\r\n  .fill(null)\r\n  .reduce((res: any, v: any, i: number) => { \r\n    const n = i + 1; \r\n    res[n] = calculateNoteFrequency(i+1); \r\n    return res;\r\n  }, {}\r\n) as FrequencyMap;\r\n\r\nexport default frequencyMap;","import DeviceController from './DeviceController'\r\nimport frequencyMap from './frequencyMap'\r\n\r\nexport type MidiEvent = {\r\n  handlerName: string,\r\n  group: string,\r\n  name: string,\r\n  type: string,\r\n  channel: number,\r\n  command: number,\r\n  note: number,\r\n  velocity: number,\r\n  frequency: number,\r\n  change: number,\r\n}\r\nexport type MidiTapEvent = MidiEvent\r\nexport type MidiAftertouchEvent = MidiEvent\r\nexport type MidiParameterEvent = MidiEvent\r\nexport type MidiNoteEvent = MidiEvent\r\nexport type MidiEventHandler<T> = (e: T) => void\r\n\r\nexport type MidiControl = {\r\n  type: 'selector' | 'pad',\r\n  group?: string,\r\n  name: string,\r\n}\r\nexport type MidiEventTargetConfiguration = {\r\n  revision?: number,\r\n  layout?: 'horizontal'|'vertical'|string,\r\n  flowDirection?: 'inverted'|'',\r\n  globalGroups?: MidiControl[][],\r\n  channels: number,\r\n  channelControls: MidiControl[],\r\n}\r\n\r\nexport type MidiEventTarget = {\r\n  id: string,\r\n  config: MidiEventTargetConfiguration,\r\n  onTouchStart?: MidiEventHandler<MidiTapEvent>\r\n  onAfterTouch?: MidiEventHandler<MidiAftertouchEvent>\r\n  onTouchEnd?: MidiEventHandler<MidiTapEvent>\r\n  onParameterChange?: MidiEventHandler<MidiParameterEvent>\r\n  onNoteOn?: MidiEventHandler<MidiNoteEvent>\r\n  onNoteOff?: MidiEventHandler<MidiNoteEvent>\r\n  onUnknownEvent?: MidiEventHandler<MidiEvent>\r\n}\r\n\r\nconst event: MidiEvent = {\r\n  command: 0,\r\n  note: 0,\r\n  velocity: 0,\r\n  frequency: 0,\r\n  \r\n  handlerName: '',\r\n\r\n  group: '',\r\n  name: '',\r\n  type: '',\r\n  channel: 0,\r\n  change: 0\r\n}\r\n\r\nObject.seal(event)\r\n\r\nexport function processMidiMessage(controller: DeviceController, message: any) {\r\n\r\n  event.command = message.data[0]\r\n  event.note = message.data[1]\r\n  event.velocity = message.data[2];\r\n    \r\n  const eventId = `${event.command}-${event.note}`;\r\n\r\n  // Mapped control\r\n  const mapping = controller.midiMap.fromMidi[eventId];\r\n  \r\n  \r\n  if (mapping) {\r\n\r\n    event.frequency = 0;\r\n    event.change = 0;\r\n    event.name = mapping.name;\r\n    event.type = mapping.type;\r\n    event.channel = mapping.channel;\r\n    switch (mapping.type) {\r\n      case 'selector':\r\n        event.handlerName = 'onParameterChange';\r\n        event.change = event.velocity - 64;\r\n        break;\r\n      case 'pad':\r\n        if (event.velocity > 0) {\r\n          if (!controller.sustained[eventId]) {\r\n            controller.sustained[eventId] = true;\r\n            event.handlerName = 'onTouchStart';    \r\n          }\r\n          else {\r\n            event.handlerName = 'onAfterTouch';    \r\n          }\r\n        }\r\n        else {\r\n          delete controller.sustained[eventId];\r\n          event.handlerName = 'onTouchEnd';    \r\n        }\r\n        \r\n        break\r\n    }\r\n  }\r\n  else {\r\n    event.name = '';\r\n    event.type = '';\r\n    event.channel = 0;\r\n    event.change = 0;\r\n    switch (event.command) {\r\n      case 144: // noteOn\r\n        if (event.velocity > 0) {\r\n          event.handlerName = 'onNoteOn';\r\n        } else {\r\n          event.handlerName = 'onNoteOff';\r\n        }\r\n        event.frequency = frequencyMap[event.note];\r\n        break\r\n      case 128: // noteOff\r\n        event.frequency = frequencyMap[event.note];\r\n        event.handlerName = 'onNoteOff';\r\n        break\r\n  \r\n      default:\r\n        event.handlerName = 'onUnknownEvent';\r\n    }\r\n  }\r\n  \r\n  const fn = controller.eventTarget![event.handlerName];\r\n  fn && fn(event);\r\n}\r\n\r\n\r\n","import { v4 as uuid } from 'uuid';\r\nimport { MidiMappedControl } from '../midiContext';\r\nimport { MidiControl, MidiEventTarget, processMidiMessage } from './processMidiMessage';\r\nimport _ from 'lodash';\r\n\r\nfunction createMap() {\r\n  return { fromMidi: {}, fromControl: {} };\r\n}\r\n\r\n// SAVING & LOADING\r\nfunction getStorageKey(controller: DeviceController, eventTarget: MidiEventTarget) {\r\n  const layout = eventTarget.config.layout || 'horizontal';\r\n  return `${controller.deviceId}-${layout}-${eventTarget.id}`;\r\n}\r\nfunction loadMappings(controller: DeviceController, eventTarget?: MidiEventTarget) {\r\n  if (!eventTarget) return createMap();\r\n  const key =  getStorageKey(controller, eventTarget);\r\n  const blob = localStorage.getItem(key);\r\n  if (!blob) return createMap();\r\n  const object = JSON.parse(blob);\r\n  const rev = object.revision || 0;\r\n  const rev1 = eventTarget.config.revision || 0;\r\n  if (rev1 > rev) return createMap();\r\n  return object;\r\n}\r\nfunction saveMappings(controller: DeviceController, eventTarget: MidiEventTarget) {\r\n  const key = getStorageKey(controller, eventTarget);\r\n  const rev1 = eventTarget.config.revision || 0;\r\n  if (rev1) {\r\n    controller.midiMap.revision = rev1;\r\n  }\r\n  localStorage.setItem(key, JSON.stringify(controller.midiMap));\r\n}\r\n\r\nfunction getControlId(props: MidiMappedControl) {\r\n  const group = props.control.group ? `${props.control.group}-` : '';\r\n  return `ch${props.channel}-${group}${props.control.type}-${props.control.name}`;\r\n}\r\n\r\nexport default class DeviceController {\r\n  id: string;\r\n  deviceId: string;\r\n  device: any;\r\n  midiContext: any;\r\n  enabled: boolean = true;\r\n  connected: boolean = false;\r\n  sustained: any = {};\r\n  initialized: boolean = false;\r\n  //\r\n  eventTarget?: MidiEventTarget;\r\n  activeMapping?: MidiMappedControl;\r\n  midiMap: any = createMap();\r\n  \r\n  constructor(device: any, midiContext: any) {\r\n    // TODO DEVICE ID IS ONLY IMPORTANT WHEN THERE ARE TWO OR MORE DEVICES WITH SAME NAME\r\n    // THIS NEEDS TO BE TESTED AND SOLVED\r\n    const name = device.name.toLowerCase().replace(/\\s/g, '-');\r\n    this.deviceId = `${name}`; //-${device.id}`;  \r\n    this.midiContext = midiContext;\r\n    this.id = uuid();\r\n    device.controllerId  = this.id;\r\n    device.onmidimessage = this.onMIDIMessage.bind(this); \r\n    this.device = device;\r\n    this.connected = device.state === 'connected';\r\n  }\r\n  \r\n  // MAPPING\r\n  bindEventTarget(eventTarget?: MidiEventTarget) {\r\n    this.eventTarget = eventTarget;\r\n    this.midiMap = loadMappings(this, eventTarget);\r\n  }\r\n\r\n  beginMapping(mappedControl: MidiMappedControl) {\r\n    const rerender = this.activeMapping ? this.activeMapping.rerender : () => {};\r\n    this.activeMapping = mappedControl;\r\n    this.activeMapping.rerender();\r\n    rerender();\r\n  }\r\n  cancelMapping() {\r\n    const rerender = this.activeMapping ? this.activeMapping.rerender : () => {};\r\n    this.activeMapping = undefined;\r\n    rerender();\r\n  }\r\n\r\n  finalizeMapping(message: number[]) {\r\n    \r\n    const channel = this.activeMapping!.channel;\r\n    const { type, name, group } = this.activeMapping!.control!;\r\n    const [ command, note ] = message;\r\n\r\n    // 1st mapping: command-note -> channel-type-name\r\n    this.midiMap.fromMidi[`${command}-${note}`] = { channel, type, name, group };\r\n\r\n    // 2st mapping: channel-type-name -> command-note\r\n    const controlId = getControlId(this.activeMapping!);\r\n    this.midiMap.fromControl[controlId] = { command, note };\r\n\r\n    saveMappings(this, this.eventTarget!);\r\n    \r\n    const rerender = this.activeMapping ? this.activeMapping.rerender : () => {};\r\n    this.activeMapping = undefined;\r\n    rerender();\r\n\r\n  }\r\n\r\n  getMappedEventData(controlId?: string) {\r\n    if (!controlId) return;\r\n    return this.midiMap.fromControl[controlId];\r\n  }\r\n\r\n  ////////////////////////////////////////////////////////\r\n  ////////////////////////////////////////////////////////\r\n  ////////////////////////////////////////////////////////\r\n  \r\n  disconnect() {\r\n    delete this.device.onmidimessage;\r\n    this.connected = false;\r\n  }\r\n  \r\n  onMIDIMessage(message: any) {\r\n    if (!this.eventTarget) return;\r\n    if (!this.enabled) return;\r\n    if (this.activeMapping) return this.finalizeMapping(message.data);\r\n    processMidiMessage(this, message);\r\n  }\r\n\r\n  enable(state: boolean) {\r\n    this.midiContext.setControllers(items => \r\n      items.map(d => {\r\n          if (d.id === this.id) {\r\n              d.enabled = state;\r\n          }\r\n          return d;\r\n      })\r\n    );\r\n  }\r\n}\r\n","import {requestMidiDevices} from './requestMidiDevices';\r\nimport DeviceController from './DeviceController';\r\n\r\n/////////////////////////////////////////////////////////////////////// INITIALIZE\r\n\r\nexport async function initialize(midiContext: any) {\r\n\r\n    const detectedDevices = await requestMidiDevices((e: any) => {\r\n    \r\n        let found = false;\r\n        let changes = 0;\r\n        const newList = midiContext.controllers.map((c:any) => {\r\n            if (c.id === e.port.controllerId) {\r\n                found = true;\r\n                const newState = e.port.state === 'connected';\r\n                if (c.connected !== newState) {\r\n                    changes++;\r\n                    c.connected = newState;\r\n                }\r\n                \r\n            }\r\n            if (!c.connected) {\r\n                delete c.device.onmidimessage;\r\n                return null;\r\n            }\r\n            return c;\r\n        }).filter((c:any) => !!c);\r\n    \r\n        if (!found) {\r\n            console.log('New device found');\r\n            newList.push(new DeviceController(e.port, midiContext));\r\n            changes++;\r\n        }\r\n    \r\n        if (changes > 0) {\r\n            midiContext.setControllers(newList);\r\n        }\r\n    \r\n    });\r\n\r\n    const devices = detectedDevices\r\n        .filter((d: any) => d.name !== 'loopMIDI Port')\r\n        .map((d: any) => new DeviceController(d, midiContext));\r\n\r\n    midiContext.setControllers(devices);\r\n\r\n\r\n}\r\n\r\n\r\n","export function requestMidiDevices(onStateChange?: Function) {\r\n    \r\n    return new Promise<any>((resolve, reject) => {\r\n\r\n        const navi: {requestMIDIAccess?: Function} = navigator as any;\r\n\r\n        if (navi.requestMIDIAccess) {\r\n            navi.requestMIDIAccess().then(\r\n\r\n                (midiAccess: any) => {\r\n                    const inputs = midiAccess.inputs.values();\r\n                    const devices: any[] = [];\r\n                    for (let device of inputs) {\r\n                        devices.push(device);\r\n                    }\r\n\r\n                    if (onStateChange) {\r\n                        midiAccess.onstatechange = onStateChange;\r\n                    }\r\n\r\n                    resolve(devices);\r\n                }, \r\n\r\n                () => console.log('Could not access your MIDI devices.'),\r\n\r\n            );\r\n        } \r\n        \r\n    });\r\n}\r\n\r\n\r\n","import clsx from 'clsx';\nimport React__default, { useMemo, useRef, useState, useEffect, createElement, Fragment as Fragment$1 } from 'react';\nimport Card from '@material-ui/core/Card';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles, createStyles, useTheme } from '@material-ui/core/styles';\nimport _, { isNumber as isNumber$1 } from 'lodash';\nimport Drawer from '@material-ui/core/Drawer';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport { v4 } from 'uuid';\nimport { loremIpsum as loremIpsum$1 } from 'lorem-ipsum';\nimport { Paper } from '@material-ui/core';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Slide from '@material-ui/core/Slide';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar fnOrValue = function fnOrValue(element, param) {\n  if (typeof element === 'function') {\n    return element(param);\n  }\n\n  return element;\n};\nvar inline = {\n  fnOrValue: fnOrValue,\n  \"switch\": function _switch(rootKey, defaultValue) {\n    var matchSingleKey = function matchSingleKey(key) {\n      if (typeof key === 'function') {\n        return key(rootKey);\n      }\n\n      return key === rootKey;\n    };\n\n    var matchKey = function matchKey(key) {\n      if (Array.isArray(key)) {\n        return key.some(matchSingleKey);\n      }\n\n      return matchSingleKey(key);\n    };\n\n    for (var _len = arguments.length, pairs = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      pairs[_key - 2] = arguments[_key];\n    }\n\n    for (var i = 0; i < pairs.length; i += 2) {\n      var key = pairs[i];\n\n      if (matchKey(key)) {\n        return fnOrValue(pairs[i + 1], key);\n      }\n    }\n\n    return fnOrValue(defaultValue, rootKey);\n  },\n  range: function range() {\n    if (arguments.length < 1) throw new Error('Usage: range(n) or range(s, e)');\n    if (arguments.length > 2) throw new Error('Usage: range(n) or range(s, e)');\n\n    var _ref = arguments.length === 1 ? {\n      start: 1,\n      end: arguments.length <= 0 ? undefined : arguments[0]\n    } : {\n      start: arguments.length <= 0 ? undefined : arguments[0],\n      end: arguments.length <= 1 ? undefined : arguments[1]\n    },\n        start = _ref.start,\n        end = _ref.end;\n\n    var n = Math.max(start, end) - Math.min(start, end) + 1;\n    var arr = new Array(n);\n    var step = end > start ? 1 : -1;\n    var i = 0;\n    var j = n;\n    var k = start;\n\n    while (j--) {\n      arr[i++] = k;\n      k += step;\n    }\n\n    return arr;\n  }\n};\n\nvar strutil = {\n  camelToSentenceCase: function camelToSentenceCase(string) {\n    if (!string) return string;\n    var tokens = string.replace(/([A-Z]+|[0-9]+)/g, ' $1').trim().split(' ');\n    return tokens.filter(function (t) {\n      return t && t.length;\n    }).map(function (token) {\n      var trimmed = token.trim();\n      return trimmed[0].toUpperCase() + trimmed.substring(1);\n    }).join(' ');\n  },\n  camelToKebabCase: function camelToKebabCase(string) {\n    if (!string) return string;\n    var tokens = string.replace(/([A-Z]+)/g, ' $1').trim().split(' ');\n    return tokens.map(function (token) {\n      return token.trim().toLowerCase();\n    }).join('-');\n  },\n  toProperCase: function toProperCase(string) {\n    if (!string) return string;\n    return string[0].toUpperCase() + string.substring(1);\n  },\n  mutateWhile: function mutateWhile(original, condition, transform) {\n    var result = original;\n\n    while (condition(result)) {\n      result = transform(result);\n    }\n\n    return result;\n  },\n  toCamelCase: function toCamelCase(string) {\n    if (!string) return string;\n    var temp = string.replace(/\\s/g, '').trim();\n    if (temp.length === 0) return '';\n    return temp[0].toLowerCase() + temp.substring(1);\n  },\n  removeDoubleSpaces: function removeDoubleSpaces(string) {\n    return strutil.mutateWhile(string, function (s) {\n      return s.indexOf('  ') >= 0;\n    }, function (s) {\n      return s.replaceAll(/\\s\\s/g, ' ');\n    }).trim();\n  }\n};\n\nfunction all(array, test) {\n  var someAreFalse = array.some(function (x) {\n    return !test(x);\n  });\n  return !someAreFalse;\n}\nfunction uniques(array) {\n  return Array.from(new Set(array));\n}\nfunction toDictionary(items, key) {\n  return items.reduce(function (dict, item) {\n    var _Object$assign;\n\n    return Object.assign(dict, (_Object$assign = {}, _Object$assign[key(item)] = item, _Object$assign));\n  }, {});\n}\nfunction sortBy(valueForItem, order) {\n  var dir = order && order === 'desc' ? -1 : 1;\n  return function (a, b) {\n    return (valueForItem(a) < valueForItem(b) ? -1 : 1) * dir;\n  };\n}\nfunction sortByDesc(valueForItem) {\n  return function (a, b) {\n    return valueForItem(a) > valueForItem(b) ? -1 : 1;\n  };\n}\nvar array = {\n  all: all,\n  uniques: uniques,\n  sortBy: sortBy,\n  sortByDesc: sortByDesc,\n  toDictionary: toDictionary\n};\n\nfunction parse(date) {\n  var d = new Date();\n  var offsetMinutes = d.getTimezoneOffset();\n  var minutes = offsetMinutes % 60;\n  var hours = offsetMinutes / 60;\n  var hh = hours.toString().padStart(2, '0');\n  var mm = minutes.toString().padStart(2, '0');\n  var adjustmentTime = hh + \":\" + mm;\n  var yyyymmdd = date.split('T')[0];\n\n  var _yyyymmdd$split = yyyymmdd.split('-'),\n      yyyy = _yyyymmdd$split[0],\n      MM = _yyyymmdd$split[1],\n      dd = _yyyymmdd$split[2];\n\n  var value = new Date(yyyy + \"-\" + MM + \"-\" + dd + \"T\" + adjustmentTime + \":00.000\");\n  return value;\n}\nfunction isoToInt(isoDate) {\n  var _isoDate$split$0$spli = isoDate.split('T')[0].split('-'),\n      yyyy = _isoDate$split$0$spli[0],\n      MM = _isoDate$split$0$spli[1],\n      dd = _isoDate$split$0$spli[2];\n\n  return parseInt(\"\" + yyyy + MM + dd, 10);\n}\nvar date = {\n  parse: parse,\n  isoToInt: isoToInt\n};\n\nfunction isNullOrUndefined(value) {\n  return typeof value === 'undefined' || value === null;\n}\n\nvar _excluded = [\"path\", \"depth\"],\n    _excluded2 = [\"path\", \"depth\"];\nfunction traverseObject(value, ctx) {\n  if (ctx.debug) console.log(new Array(ctx.depth).fill(' ').join('') + 'traverseObject value:', value, ' ctx:', ctx);\n  var results = [];\n\n  if (isNullOrUndefined(value)) {\n    return results;\n  }\n\n  var path = ctx.path,\n      depth = ctx.depth,\n      other = _objectWithoutPropertiesLoose(ctx, _excluded);\n\n  for (var _i = 0, _Object$keys = Object.keys(value); _i < _Object$keys.length; _i++) {\n    var key = _Object$keys[_i];\n    results = results.concat(traverseLeaf(value[key], _extends({}, other, {\n      path: path.concat(key),\n      depth: depth + 1,\n      key: key,\n      index: key\n    })));\n  }\n\n  var symbols = Object.getOwnPropertySymbols(value);\n\n  if (symbols.length) {\n    for (var _iterator = _createForOfIteratorHelperLoose(symbols), _step; !(_step = _iterator()).done;) {\n      var symbol = _step.value;\n      results = results.concat(traverseLeaf(value[symbol], _extends({}, other, {\n        path: path.concat(symbol),\n        depth: depth + 1,\n        key: symbol,\n        index: symbol\n      })));\n    }\n  }\n\n  return results;\n}\nfunction traverseLeaf(value, ctx) {\n  if (ctx.debug) console.log(new Array(ctx.depth).fill(' ').join('') + 'traverseLeaf value:', value, ' ctx:', ctx);\n  var results = [];\n  var cbContext = {\n    value: value,\n    type: typeof value,\n    contructorName: value ? value.constructor.name : undefined,\n    key: ctx.key,\n    path: ctx.path.map(function (t) {\n      var token = typeof t === 'string' ? t : t.toString();\n      return token[0] === '[' ? token : '.' + token;\n    }).join('').substring(1),\n    tokens: ctx.path\n  };\n\n  if (ctx.find && ctx.select && ctx.find(cbContext)) {\n    return ctx.select(cbContext);\n  }\n\n  if (ctx.filter) {\n    if (ctx.filter(cbContext)) {\n      if (ctx.visit) {\n        ctx.visit(cbContext);\n      }\n\n      if (ctx.select) {\n        results = results.concat(ctx.select(cbContext));\n      }\n    }\n  } else {\n    if (ctx.visit) {\n      ctx.visit(cbContext);\n    }\n\n    if (ctx.select) {\n      results = results.concat(ctx.select(cbContext));\n    }\n  }\n\n  if (Array.isArray(value)) {\n    if (!ctx.expand || ctx.expand(cbContext)) {\n      results = results.concat(traverseArray(value, ctx));\n    }\n  } else if (typeof value === 'object') {\n    if (!ctx.expand || ctx.expand(cbContext)) {\n      results = results.concat(traverseObject(value, ctx));\n    }\n  }\n\n  return results;\n}\nfunction traverseArray(value, ctx) {\n  if (ctx.debug) console.log(new Array(ctx.depth).fill(' ').join('') + 'traverseArray value:', value, ' ctx:', ctx);\n  var results = [];\n\n  var path = ctx.path,\n      depth = ctx.depth,\n      other = _objectWithoutPropertiesLoose(ctx, _excluded2);\n\n  for (var index = 0; index < value.length; index++) {\n    results = results.concat(traverseLeaf(value[index], _extends({}, other, {\n      path: path.concat(\"[\" + index + \"]\"),\n      depth: depth + 1,\n      key: index,\n      index: index\n    })));\n  }\n\n  return results;\n}\n\nvar traverse = function traverse(source, strategy) {\n  var ns = typeof strategy === 'object' && Reflect.has(strategy, 'namespace') ? strategy.namespace : null;\n  var initialPathTokens = ns ? [ns] : [];\n  var options = typeof strategy === 'object' ? strategy : {\n    select: strategy\n  };\n  var results = traverseLeaf(source, _extends({}, options, {\n    path: initialPathTokens,\n    depth: 0\n  }));\n  return results;\n};\n\nfunction assignPath(target, tokens, value) {\n  var cursor = target;\n\n  for (var i = 0; i < tokens.length; i += 1) {\n    var token = tokens[i];\n    var node = cursor[token];\n    var t = typeof node;\n\n    if (t === 'undefined' || node === null) {\n      cursor[token] = {};\n    } else if (Array.isArray(cursor[token])) {\n      cursor[token] = _extends({}, cursor[token]);\n    } else if (t === 'object') {\n      cursor[token] = _extends({}, node);\n    }\n\n    if (i === tokens.length - 1) {\n      cursor[token] = value;\n      return value;\n    }\n\n    cursor = cursor[token];\n  }\n\n  return value;\n}\n\nfunction selectShape(object, shape) {\n  var selectors = traverse(shape, {\n    select: function select(x) {\n      return {\n        tokens: x.tokens,\n        key: x.key,\n        alias: x.value\n      };\n    }\n  });\n  var result = selectors.reduce(function (map, selector) {\n    var tokens = selector.tokens.slice(0, selector.tokens.length - 1);\n    var sourcePath = [].concat(tokens, [selector.key]).join('.');\n\n    var value = _.get(object, sourcePath);\n\n    var targetPathTokens = [].concat(tokens, [selector.alias]);\n    assignPath(map, targetPathTokens, value);\n    return map;\n  }, {});\n  return result;\n}\n\nfunction intersect(object, shape) {\n  var keys = Object.keys(shape).filter(function (k) {\n    return Reflect.has(object, k);\n  });\n  return keys.reduce(function (target, key) {\n    target[key] = object[key];\n    return target;\n  }, {});\n}\n\nfunction _sum(args) {\n  return args.reduce(function (acc, item) {\n    return acc + item;\n  }, 0);\n}\n\nvar aggregate = function aggregate(source, fn, select, defaultValue) {\n  if (!source) {\n    return defaultValue;\n  }\n\n  return Object.keys(source).map(function (key) {\n    var item = {\n      key: key,\n      item: source[key]\n    };\n    return item;\n  }).reduce(function (acc, elem) {\n    var itemValue = select(elem.item, elem.key, source);\n    var result = fn(acc, itemValue);\n    return result;\n  }, defaultValue);\n};\n\nvar fnConcat = function fnConcat(acc, arr) {\n  return acc.concat(arr);\n};\n\nvar MapReduceObject = /*#__PURE__*/function () {\n  function MapReduceObject(object) {\n    this.object = object;\n  }\n\n  var _proto = MapReduceObject.prototype;\n\n  _proto.count = function count() {\n    return Object.keys(this.object).length;\n  };\n\n  _proto.map = function map(select) {\n    var _this = this;\n\n    return Object.entries(this.object).map(function (_ref) {\n      var key = _ref[0],\n          value = _ref[1];\n\n      if (select) {\n        return select(value, key, _this.object);\n      }\n\n      return value;\n    });\n  };\n\n  _proto.concat = function concat(select) {\n    return aggregate(this.object, fnConcat, select, []);\n  };\n\n  _proto.min = function min(select) {\n    return aggregate(this.object, Math.min, select, Number.MAX_VALUE);\n  };\n\n  _proto.max = function max(select) {\n    return aggregate(this.object, Math.max, select, Number.MIN_VALUE);\n  };\n\n  _proto.sum = function sum(select) {\n    return _sum(this.map(select));\n  };\n\n  _proto.avg = function avg(select) {\n    var values = this.map(select);\n    if (values.length === 0) return 0;\n    return _sum(values) / values.length;\n  };\n\n  return MapReduceObject;\n}();\n\nvar Object$1 = {\n  traverse: traverse,\n  assignPath: assignPath,\n  selectShape: selectShape,\n  intersect: intersect,\n  mapReduce: function mapReduce(obj) {\n    return new MapReduceObject(obj);\n  }\n};\n\nvar util = {\n  array: array,\n  logic: inline,\n  object: Object$1,\n  string: strutil,\n  date: date\n};\n\nvar useStyles = makeStyles({\n  root: {\n    maxWidth: 345\n  },\n  media: {\n    height: 140\n  }\n});\nfunction MediaCard(props) {\n  var title = props.title,\n      description = props.description,\n      image = props.image,\n      _onClick = props.onClick,\n      footerActions = props.footerActions,\n      children = props.children;\n  var classes = useStyles();\n  return /*#__PURE__*/React__default.createElement(Card, {\n    className: classes.root\n  }, /*#__PURE__*/React__default.createElement(CardActionArea, {\n    onClick: function onClick() {\n      return _onClick && _onClick();\n    }\n  }, image && /*#__PURE__*/React__default.createElement(CardMedia, {\n    className: classes.media,\n    image: image.url,\n    title: title\n  }), /*#__PURE__*/React__default.createElement(CardContent, null, title && /*#__PURE__*/React__default.createElement(Typography, {\n    gutterBottom: true,\n    variant: \"h5\",\n    component: \"h2\"\n  }, title), description && /*#__PURE__*/React__default.createElement(Typography, {\n    variant: \"body2\",\n    color: \"textSecondary\",\n    component: \"p\"\n  }, description), children && children)), footerActions && /*#__PURE__*/React__default.createElement(CardActions, null, Object.keys(footerActions).map(function (key) {\n    return /*#__PURE__*/React__default.createElement(Button, {\n      key: key,\n      size: \"small\",\n      color: \"primary\",\n      onClick: function onClick() {\n        return footerActions[key]();\n      }\n    }, util.string.camelToSentenceCase(key));\n  })));\n}\n\nvar useInlineStyle = function useInlineStyle(style, dependencies) {\n  var cb = useMemo(function () {\n    return makeStyles(function () {\n      return createStyles(_extends({}, util.logic.fnOrValue(style)));\n    });\n  }, [style, dependencies]);\n  return cb;\n};\n\nvar defaultMinCount = 0;\nvar counter = (function (props) {\n  var ref = React__default.useRef({\n    count: 0\n  }).current;\n\n  if (++ref.count <= (typeof props.min !== 'undefined' ? props.min : defaultMinCount)) {\n    return null;\n  }\n\n  var classes = useInlineStyle({\n    root: {\n      position: 'absolute',\n      zIndex: 999999,\n      top: 0,\n      left: 0,\n      padding: '0 3px',\n      lineHeight: 1,\n      fontSize: '.7rem',\n      backgroundColor: 'red',\n      color: 'white'\n    }\n  }, [])();\n  return /*#__PURE__*/React__default.createElement(\"div\", {\n    title: props.title,\n    className: classes.root\n  }, ref.count);\n});\n\nvar Header = function Header(props) {\n  var cols = props.cols || [];\n  return /*#__PURE__*/React__default.createElement(\"thead\", null, /*#__PURE__*/React__default.createElement(\"tr\", null, cols.map(function (c, index) {\n    return /*#__PURE__*/React__default.createElement(\"th\", {\n      key: index\n    }, c);\n  })));\n};\n\nvar TableRow = function TableRow(props) {\n  var item = props.item;\n  var cols = props.cols;\n  var isArray = Array.isArray(item);\n  return /*#__PURE__*/React__default.createElement(\"tr\", {\n    className: \"no-text-overflow\"\n  }, isArray && item.map(function (value, index) {\n    return /*#__PURE__*/React__default.createElement(\"td\", {\n      key: cols[index]\n    }, typeof value === 'number' && value.toFixed(0));\n  }), !isArray && cols.map(function (c, index) {\n    return /*#__PURE__*/React__default.createElement(\"td\", {\n      key: cols[index]\n    }, typeof item[c] === 'number' && item[c].toFixed(0));\n  }));\n};\n\nvar Table = function Table(props) {\n  var cols = props.cols;\n  var items = props.items;\n  if (!items) return null;\n  return /*#__PURE__*/React__default.createElement(\"table\", {\n    cellPadding: 0,\n    cellSpacing: 0,\n    className: \"data-table\"\n  }, cols && cols.length > 0 && /*#__PURE__*/React__default.createElement(Header, {\n    cols: cols\n  }), /*#__PURE__*/React__default.createElement(\"tbody\", null, items.map(function (item, itemIndex) {\n    return /*#__PURE__*/React__default.createElement(TableRow, {\n      key: itemIndex,\n      item: item,\n      cols: cols\n    });\n  })));\n};\n\nvar drawer = (function (props) {\n  var _React$useState = React__default.useState(false),\n      open = _React$useState[0],\n      setOpen = _React$useState[1];\n\n  var _React$useState2 = React__default.useState(),\n      closed = _React$useState2[0],\n      setClosed = _React$useState2[1];\n\n  var externallyControlled = typeof props.open !== 'undefined';\n  var drawerOpen = !closed && (externallyControlled ? props.open : open);\n\n  var toggleDrawer = function toggleDrawer(open) {\n    return function (event) {\n      setOpen(open);\n\n      if (!open) {\n        setClosed(true);\n      }\n\n      if (open && props.onOpen) props.onOpen();\n      if (!open && props.onClose) props.onClose();\n    };\n  };\n\n  return /*#__PURE__*/React__default.createElement(React__default.Fragment, null, props.button && !drawerOpen && React__default.cloneElement(props.button, {\n    onClick: toggleDrawer(true)\n  }), /*#__PURE__*/React__default.createElement(Drawer, {\n    anchor: props.anchor,\n    open: drawerOpen,\n    onClose: toggleDrawer(false)\n  }, !closed && drawerOpen && props.children));\n});\n\nvar attributeMap = {\n  bgColor: 'backgroundColor'\n};\n\nfunction resolveAttributeValue(key, value) {\n  if (!value) return value;\n  return value.hex ? value.hex() : value;\n}\n\nvar classMap = {\n  scrollableX: 'scrollable scrollable-x',\n  scrollableY: 'scrollable scrollable-y',\n  borderBox: 'border-box'\n};\n\nfunction getOrMakeStyle(x) {\n  var _ref;\n\n  var resolvedKey = Reflect.has(attributeMap, x.key) ? attributeMap[x.key] : x.key;\n  return _ref = {}, _ref[resolvedKey] = resolveAttributeValue(resolvedKey, x.value), _ref;\n}\nfunction createStyle(x) {\n  Object.assign(x.bag.style, getOrMakeStyle(x));\n  return true;\n}\nfunction createClass(x) {\n  var resolvedClass = Reflect.has(classMap, x.key) ? classMap[x.key] : strutil.camelToKebabCase(x.key);\n  x.bag.classes.push(resolvedClass);\n  return true;\n}\n\nvar switches = {\n  absolute: true,\n  alignStart: true,\n  alignCenter: true,\n  alignEnd: true,\n  alignStretch: true,\n  alignBaseline: true,\n  alignAuto: true,\n  alignSelfStart: true,\n  alignSelfCenter: true,\n  alignSelfEnd: true,\n  alignSelfStretch: true,\n  alignSelfBaseline: true,\n  anchorBottom: true,\n  anchorLeft: true,\n  anchorRight: true,\n  anchorTop: true,\n  beveled: true,\n  block: true,\n  borderBox: true,\n  centerX: true,\n  centerXY: true,\n  centerY: true,\n  clickable: true,\n  coverImage: true,\n  fill: true,\n  fixed: true,\n  fullWidth: true,\n  fullWidthAlways: true,\n  grow: true,\n  hidden: true,\n  horizontal: true,\n  inline: true,\n  inlineBlock: true,\n  justifyStart: true,\n  justifyCenter: true,\n  justifyEnd: true,\n  mobileCenter: true,\n  mobileColumn: true,\n  mobileOnly: true,\n  noBr: true,\n  noBreak: true,\n  noMargin: true,\n  noMobile: true,\n  noOverflow: true,\n  noPadding: true,\n  noSelect: true,\n  noTransform: true,\n  noWrap: true,\n  opaque: true,\n  overlay: true,\n  relative: true,\n  round: true,\n  rounded: true,\n  scrollable: true,\n  scrollableX: true,\n  scrollableY: true,\n  shrink: true,\n  small: true,\n  smaller: true,\n  solid: true,\n  spaced: true,\n  sticky: true,\n  tall: true,\n  translucent: true,\n  vertical: true,\n  wide: true\n};\n\nvar styleAttributes = {\n  backgroundColor: createStyle,\n  bgColor: createStyle,\n  backgroundImage: createStyle,\n  backgroundRepeat: createStyle,\n  backgroundPosition: createStyle,\n  backgroundSize: createStyle,\n  border: createStyle,\n  borderTop: createStyle,\n  borderRight: createStyle,\n  borderBottom: createStyle,\n  borderLeft: createStyle,\n  borderRadius: createStyle,\n  borderTopLeftRadius: createStyle,\n  borderTopRightRadius: createStyle,\n  borderBottomLeftRadius: createStyle,\n  borderBottomRightRadius: createStyle,\n  color: createStyle,\n  cursor: createStyle,\n  dataProps: createStyle,\n  fontSize: createStyle,\n  fontStyle: createStyle,\n  fontWeight: createStyle,\n  innerProps: createStyle,\n  lineHeight: createStyle,\n  margin: createStyle,\n  marginTop: createStyle,\n  marginRight: createStyle,\n  marginBottom: createStyle,\n  marginLeft: createStyle,\n  minHeight: createStyle,\n  minWidth: createStyle,\n  opacity: createStyle,\n  padding: createStyle,\n  paddingTop: createStyle,\n  paddingRight: createStyle,\n  paddingBottom: createStyle,\n  paddingLeft: createStyle,\n  pseudo: createStyle,\n  textAlign: createStyle,\n  textTransform: createStyle,\n  title: createStyle,\n  width: createStyle,\n  height: createStyle,\n  top: createStyle,\n  right: createStyle,\n  bottom: createStyle,\n  left: createStyle\n};\n\nvar _excluded$1 = [\"id\", \"children\", \"style\", \"className\", \"ref\", \"data\", \"pseudo\", \"innerProps\", \"css\", \"onBlur\", \"onClick\", \"onChange\", \"onFocus\", \"onMouseUp\", \"onMouseDown\", \"onMouseMove\"],\n    _excluded2$1 = [\"dataProps\"];\n\nfunction useStyleDirectives(directives, ownProps, tagName) {\n  var id = directives.id,\n      children = directives.children,\n      style = directives.style,\n      className = directives.className,\n      ref = directives.ref,\n      data = directives.data,\n      pseudo = directives.pseudo,\n      innerProps = directives.innerProps,\n      css = directives.css,\n      onBlur = directives.onBlur,\n      onClick = directives.onClick,\n      onChange = directives.onChange,\n      onFocus = directives.onFocus,\n      onMouseUp = directives.onMouseUp,\n      onMouseDown = directives.onMouseDown,\n      onMouseMove = directives.onMouseMove,\n      other = _objectWithoutPropertiesLoose(directives, _excluded$1);\n\n  var ignoredProps = {\n    id: id,\n    children: children,\n    style: style,\n    className: className,\n    ref: ref,\n    data: data,\n    pseudo: pseudo,\n    innerProps: innerProps,\n    ownProps: ownProps,\n    css: css,\n    onBlur: onBlur,\n    onClick: onClick,\n    onChange: onChange,\n    onFocus: onFocus,\n    onMouseUp: onMouseUp,\n    onMouseDown: onMouseDown,\n    onMouseMove: onMouseMove\n  };\n  var utilizedKeys = [];\n  var keys = Object.keys(other);\n  var bag = {\n    style: _extends({}, css, style),\n    classes: []\n  };\n  keys.forEach(function (key) {\n    if (!Reflect.has(ignoredProps, key)) {\n      var value = directives[key];\n\n      if (Reflect.has(switches, key)) {\n        createClass({\n          bag: bag,\n          key: key,\n          value: value,\n          debug: false\n        });\n        utilizedKeys.push(key);\n        return;\n      }\n\n      if (Reflect.has(styleAttributes, key)) {\n        styleAttributes[key]({\n          bag: bag,\n          key: key,\n          value: value\n        });\n        utilizedKeys.push(key);\n        return;\n      }\n\n      if (value === true) {\n        createClass({\n          bag: bag,\n          key: key,\n          value: value,\n          debug: false\n        });\n      }\n    }\n  });\n\n  var props = _extends({}, other);\n\n  utilizedKeys.forEach(function (key) {\n    delete props[key];\n  });\n  var pseudoStyles = Object.keys(directives.pseudo || {}).reduce(function (acc, key) {\n    var _Object$assign;\n\n    var s = directives.pseudo[key];\n    var fullKey = key[0] === '&' ? key : \"& :\" + key;\n    return Object.assign(acc, (_Object$assign = {}, _Object$assign[fullKey] = s, _Object$assign));\n  }, {});\n  var usedStyles = makeStyles(function () {\n    var s = {};\n    if (Object.keys(bag.style).length) s.bag = bag.style;\n    if (Object.keys(pseudoStyles).length) s.pseudo = pseudoStyles;\n    return s;\n  })();\n  var events = {\n    onBlur: onBlur,\n    onClick: onClick,\n    onChange: onChange,\n    onFocus: onFocus,\n    onMouseUp: onMouseUp,\n    onMouseDown: onMouseDown,\n    onMouseMove: onMouseMove\n  };\n\n  var dataProps = directives.dataProps,\n      attr = _objectWithoutPropertiesLoose(directives, _excluded2$1);\n\n  for (var _len = arguments.length, baseClasses = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    baseClasses[_key - 3] = arguments[_key];\n  }\n\n  var result = {\n    root: {\n      className: clsx(className, baseClasses, tagName, bag.classes, usedStyles.bag, usedStyles.pseudo)\n    },\n    props: _extends({}, props, ignoredProps),\n    attr: attr,\n    data: dataProps,\n    events: events\n  };\n  return result;\n}\n\nvar _excluded$2 = [\"children\"],\n    _excluded2$2 = [\"children\"],\n    _excluded3 = [\"children\"];\nvar div = function div(directives) {\n  var children = directives.children,\n      other = _objectWithoutPropertiesLoose(directives, _excluded$2);\n\n  var _useStyleDirectives = useStyleDirectives(other, null),\n      root = _useStyleDirectives.root,\n      data = _useStyleDirectives.data,\n      events = _useStyleDirectives.events;\n\n  return /*#__PURE__*/React__default.createElement(\"div\", _extends({}, data, {\n    className: root.className\n  }, events), children);\n};\nvar row = function row(directives) {\n  var children = directives.children,\n      other = _objectWithoutPropertiesLoose(directives, _excluded2$2);\n\n  var _useStyleDirectives2 = useStyleDirectives(other, null, 'Row', 'flex row'),\n      root = _useStyleDirectives2.root,\n      data = _useStyleDirectives2.data,\n      events = _useStyleDirectives2.events;\n\n  return /*#__PURE__*/React__default.createElement(\"div\", _extends({}, data, {\n    className: root.className\n  }, events), children);\n};\nvar col = function col(directives) {\n  var children = directives.children,\n      other = _objectWithoutPropertiesLoose(directives, _excluded3);\n\n  var _useStyleDirectives3 = useStyleDirectives(other, null, 'Col', 'flex column'),\n      root = _useStyleDirectives3.root,\n      data = _useStyleDirectives3.data,\n      events = _useStyleDirectives3.events;\n\n  return /*#__PURE__*/React__default.createElement(\"div\", _extends({}, data, {\n    className: root.className\n  }, events), children);\n};\n\nvar divRowCol = {\n  __proto__: null,\n  div: div,\n  row: row,\n  col: col\n};\n\nfunction Dropdown(props) {\n  var localStorageKey = props.localStorageKey,\n      label = props.label,\n      defaultValue = props.defaultValue,\n      options = props.options;\n  var labelId = v4();\n\n  var _React$useState = React__default.useState(function () {\n    var storedString = localStorageKey ? localStorage.getItem(localStorageKey) : null;\n    return storedString || defaultValue;\n  }),\n      selectedValue = _React$useState[0],\n      setSelectedValue = _React$useState[1];\n\n  var selectedValueExists = options.find(function (option) {\n    var obj = option;\n    var value = typeof obj === 'object' ? obj.value : option;\n    return selectedValue === value;\n  });\n  var auxOptions = !selectedValueExists ? [{\n    value: selectedValue,\n    text: selectedValue,\n    aux: true\n  }] : [];\n\n  var handleChange = function handleChange(event) {\n    var value = event.target.value;\n\n    if (localStorageKey) {\n      localStorage.setItem(localStorageKey, value);\n    }\n\n    setSelectedValue(value);\n    props.onChange && props.onChange(value);\n  };\n\n  return /*#__PURE__*/React__default.createElement(FormControl, null, label && /*#__PURE__*/React__default.createElement(InputLabel, {\n    id: labelId\n  }, label), /*#__PURE__*/React__default.createElement(Select, {\n    labelId: labelId,\n    value: selectedValue,\n    onChange: handleChange\n  }, [].concat(options, auxOptions).map(function (option) {\n    var obj = option;\n    var text = typeof obj === 'object' ? obj.text : option;\n    var value = typeof obj === 'object' ? obj.value : option;\n    var aux = typeof obj === 'object' ? obj.aux === true : false;\n    return /*#__PURE__*/React__default.createElement(MenuItem, {\n      key: value,\n      value: value\n    }, !aux && text, aux && /*#__PURE__*/React__default.createElement(div, {\n      opacity: 0.5,\n      fontStyle: \"italic\"\n    }, text));\n  })));\n}\n\nvar defaultProps = {\n  angle: 90\n};\nfunction createStripes(options) {\n  var params = _extends({}, defaultProps, options);\n\n  return generateStripesStyle(params);\n}\n\nfunction colorFromString(color) {\n  var tokens = color.split(' ');\n  if (tokens.length === 1) return {\n    color: tokens[0],\n    parts: 1\n  };\n  if (tokens.length === 2) return {\n    color: tokens[0],\n    parts: +tokens[1]\n  };\n  throw new Error('Max number of color tokens expected is 2');\n}\n\nfunction parseColor(color) {\n  if (typeof color === 'string') return colorFromString(color);\n  return color;\n}\n\nfunction generateStripesStyle(params) {\n  var type = 'linear-gradient';\n  var angle = params.angle;\n  var colors = params.colors ? params.colors.map(function (c) {\n    return parseColor(c);\n  }) : null;\n  var partCount = colors.reduce(function (total, c) {\n    return +total + c.parts;\n  }, 0);\n  var steps = partCount * 2;\n  var step = 100 / steps;\n  var colorCount = colors.length;\n  var n = colorCount * 2;\n  var outSegments = [];\n  var distance = 0;\n\n  for (var i = 0; i < n; i++) {\n    var index = i % colorCount;\n    var nextIndex = (i + 1) % colorCount;\n    distance += step * colors[index].parts;\n    outSegments.push(colors[index].color + ' ' + distance.toFixed(2) + '%');\n\n    if (i < n - 1) {\n      outSegments.push(colors[nextIndex].color + ' ' + distance.toFixed(2) + '%');\n    }\n  }\n\n  var size = params.size || steps;\n  var styleProps = {\n    backgroundImage: type + \"(\" + angle + \"deg, \" + outSegments.join(', ') + \")\",\n    backgroundSize: isNumber$1(size) ? size.toFixed(2) + \"px \" + size.toFixed(2) + \"px\" : size\n  };\n  return styleProps;\n}\n\nfunction createLinearGradient(options) {\n  return generateLinearGradientStyle(options);\n}\n\nfunction parseColor$1(color) {\n  var _color$percentage;\n\n  function colorFromString(color) {\n    var tokens = color.split(' ');\n\n    if (tokens.length > 2) {\n      throw new Error('Due to current limitation of this function, colors should be canonical without any spaces, e.g.: rgb(255,128,0,0.8) 75% is a valid color and stop pair.');\n    }\n\n    return tokens;\n  }\n\n  if (typeof color === 'string') return colorFromString(color);\n  return [color.color, (_color$percentage = color.percentage) === null || _color$percentage === void 0 ? void 0 : _color$percentage.toString()];\n}\n\nfunction generateLinearGradientStyle(options) {\n  var gradients = Array.isArray(options) ? options : [options];\n  var functions = gradients.map(function (g) {\n    var colors = g.colors.map(function (c) {\n      return parseColor$1(c);\n    });\n    var functionName = g.repeat ? 'repeating-linear-gradient' : 'linear-gradient';\n    return functionName + \"(\" + g.angle + \"deg, \" + colors.map(function (tuple) {\n      return tuple.join(' ');\n    }).join(', ') + \")\";\n  });\n  return {\n    backgroundImage: functions.join(', ')\n  };\n}\n\nvar BoxShadowDefaults = {\n  xOffset: 0,\n  yOffset: 0,\n  blur: 5,\n  spread: 0,\n  rgba: {\n    r: 0,\n    g: 0,\n    b: 0,\n    a: 0.75\n  }\n};\nvar boxShadow = (function (props) {\n  var init = function init() {\n    var x = _extends({}, BoxShadowDefaults, props);\n\n    var colorString = props.rgba ? \"rgba(\" + x.rgba.r + \", \" + x.rgba.g + \", \" + x.rgba.b + \", \" + x.rgba.a + \")\" : props.hex;\n    var inset = props.inset ? 'inset ' : '';\n    var value = inset + (x.xOffset + \"px \" + x.yOffset + \"px \" + x.blur + \"px \" + x.spread + \"px \" + colorString);\n    return {\n      \"-webkit-box-shadow\": value,\n      \"-moz-box-shadow\": value,\n      \"box-shadow\": value\n    };\n  };\n\n  return React__default.useState(init)[0];\n});\n\nvar isClient = typeof window === 'object';\nvar gridSizeValues = {\n  xs: 1,\n  sm: 2,\n  md: 3,\n  lg: 4,\n  xl: 5,\n  xxl: 6,\n  xxxl: 7\n};\nvar breakpointSystem = {\n  bootstrap: [[1600, 'xxxl'], [1400, 'xxl'], [1200, 'xl'], [992, 'lg'], [768, 'md'], [576, 'sm']],\n  material: [[1920, 'xl'], [1280, 'lg'], [960, 'md'], [600, 'sm']]\n};\n\nvar getGridSize = function getGridSize(system) {\n  if (!isClient) return 'xs';\n  var breaks = breakpointSystem[system];\n\n  for (var _iterator = _createForOfIteratorHelperLoose(breaks), _step; !(_step = _iterator()).done;) {\n    var x = _step.value;\n\n    if (window.innerWidth >= x[0]) {\n      return x[1];\n    }\n  }\n\n  return 'xs';\n};\n\nvar makeGridSizeResult = function makeGridSizeResult(code) {\n  return {\n    code: code,\n    value: gridSizeValues[code]\n  };\n};\n\nvar useGridSize = function useGridSize(system) {\n  var ref = useRef({\n    value: 'xs',\n    ticking: false\n  }).current;\n\n  var _useState = useState(function () {\n    return makeGridSizeResult(getGridSize(system));\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  useEffect(function () {\n    return windowEventHandler(ref, function (gridSize) {\n      return setState(makeGridSizeResult(gridSize));\n    }, 'resize', function () {\n      return getGridSize(system);\n    });\n  }, []);\n  return state;\n};\n\nfunction getWindowHeight() {\n  return window.innerHeight;\n}\n\nvar useWindowHeight = function useWindowHeight() {\n  var ref = useRef({\n    value: 0,\n    ticking: false\n  }).current;\n\n  var _useState2 = useState(function () {\n    return !isClient ? 0 : getWindowHeight();\n  }),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  useEffect(function () {\n    return windowEventHandler(ref, setState, 'resize', getWindowHeight);\n  }, [ref]);\n  return state;\n};\n\nvar getScrollPosition = function getScrollPosition() {\n  return document.body.scrollTop || document.documentElement.scrollTop;\n};\n\nvar useScrollPosition = function useScrollPosition() {\n  var ref = useRef({\n    value: 0,\n    ticking: false\n  }).current;\n\n  var _useState4 = useState(function () {\n    return !isClient ? 0 : getScrollPosition();\n  }),\n      state = _useState4[0],\n      setState = _useState4[1];\n\n  useEffect(function () {\n    return windowEventHandler(ref, setState, 'scroll', getScrollPosition);\n  }, [ref]);\n  return state;\n};\n\nfunction windowEventHandler(ref, setState, event, readValue, compare) {\n  if (!isClient) return;\n\n  var handleEvent = function handleEvent() {\n    var value = readValue();\n\n    var compareValues = compare || function (a, b) {\n      return a === b;\n    };\n\n    if (compareValues(ref.value, value)) return;\n    ref.value = value;\n\n    if (!ref.ticking) {\n      window.requestAnimationFrame(function () {\n        setState(ref.value);\n        ref.ticking = false;\n      });\n      ref.ticking = true;\n    }\n  };\n\n  window.addEventListener(event, handleEvent);\n  return function () {\n    return window.removeEventListener(event, handleEvent);\n  };\n}\n\n\n\nvar hooks = {\n  __proto__: null,\n  createStripes: createStripes,\n  createLinearGradient: createLinearGradient,\n  useBoxShadow: boxShadow,\n  useGridSize: useGridSize,\n  useWindowHeight: useWindowHeight,\n  useScrollPosition: useScrollPosition\n};\n\nvar options = {\n  count: 1,\n  format: 'plain',\n  paragraphLowerBound: 3,\n  paragraphUpperBound: 7,\n  sentenceLowerBound: 5,\n  sentenceUpperBound: 15,\n  suffix: '\\n',\n  units: 'words'\n};\n\nfunction words(count, dictionary) {\n  return loremIpsum$1(_extends({}, options, {\n    count: count,\n    units: 'words',\n    words: dictionary\n  }));\n}\n\nfunction sentences(count, dictionary) {\n  return loremIpsum$1(_extends({}, options, {\n    count: count,\n    units: 'sentences',\n    words: dictionary\n  }));\n}\n\nfunction paragraphs(count, dictionary) {\n  return loremIpsum$1(_extends({}, options, {\n    count: count,\n    units: 'paragraphs',\n    words: dictionary\n  }));\n}\n\nvar loremIpsum = {\n  words: words,\n  sentences: sentences,\n  paragraphs: paragraphs\n};\n\nvar _excluded$3 = [\"colSpan\", \"image\", \"title\", \"description\", \"onClick\"],\n    _excluded2$3 = [\"min\", \"max\", \"items\", \"elementForItem\", \"revision\"];\n\nvar ElementContainer = function ElementContainer(props) {\n  var element = props.element,\n      colSpan = props.colSpan,\n      image = props.image;\n  var inline = useInlineStyle(function () {\n    var root = {};\n\n    if (colSpan) {\n      root.gridColumnEnd = \"span \" + colSpan;\n    }\n\n    return {\n      root: root,\n      image: {\n        backgroundImage: \"url(\\\"\" + image + \"\\\")\"\n      }\n    };\n  }, [colSpan, image])();\n  return /*#__PURE__*/React__default.createElement(\"div\", {\n    className: clsx('masonry-item', 'relative', inline.root)\n  }, /*#__PURE__*/React__default.createElement(\"div\", {\n    className: \"content fill\"\n  }, element));\n};\n\nvar DefaultMasonryItem = function DefaultMasonryItem(directives) {\n  var colSpan = directives.colSpan,\n      image = directives.image,\n      title = directives.title,\n      description = directives.description,\n      _onClick = directives.onClick,\n      d = _objectWithoutPropertiesLoose(directives, _excluded$3);\n\n  var _useStyleDirectives = useStyleDirectives(d, null, 'MasonryItem', 'masonry-item'),\n      root = _useStyleDirectives.root;\n\n  var inline = useInlineStyle(function () {\n    return {\n      root: {\n        gridColumnEnd: colSpan ? \"span \" + colSpan : null\n      },\n      image: {\n        backgroundImage: \"url(\\\"\" + image + \"\\\")\"\n      }\n    };\n  }, [colSpan, image])();\n  return (\n    /*#__PURE__*/\n    React__default.createElement(\"div\", {\n      className: clsx(root.className, inline.root),\n      onClick: function onClick() {\n        return _onClick && _onClick();\n      }\n    }, /*#__PURE__*/React__default.createElement(Paper, {\n      className: \"content\"\n    }, image && /*#__PURE__*/React__default.createElement(\"div\", {\n      className: clsx('cover-image', inline.image)\n    }), title && /*#__PURE__*/React__default.createElement(\"div\", {\n      className: \"title\"\n    }, title), description && /*#__PURE__*/React__default.createElement(\"div\", {\n      className: \"desc\"\n    }, description)))\n  );\n};\n\nvar Masonry = function Masonry(directives) {\n  var min = directives.min,\n      max = directives.max,\n      items = directives.items,\n      elementForItem = directives.elementForItem,\n      revision = directives.revision,\n      d = _objectWithoutPropertiesLoose(directives, _excluded2$3);\n\n  var theme = useTheme();\n\n  var _useStyleDirectives2 = useStyleDirectives(d, null, 'Masonry', 'ui-masonry-grid masonry-grid grid'),\n      root = _useStyleDirectives2.root;\n\n  var mutable = useRef({\n    resizing: false,\n    gridItems: []\n  }).current;\n  var g = document.getElementsByClassName('masonry-grid')[0];\n\n  var _useMemo = useMemo(function () {\n    if (!g) return {\n      rowHeight: 0,\n      rowGap: 0,\n      gridItems: []\n    };\n    return {\n      grid: g,\n      rowHeight: parseInt(window.getComputedStyle(g).getPropertyValue('grid-auto-rows'), 10),\n      rowGap: parseInt(window.getComputedStyle(g).getPropertyValue('grid-row-gap'), 10),\n      gridItems: Array.from(document.getElementsByClassName('masonry-item')).map(function (e) {\n        var innerElement = e.querySelector('.content > *');\n        var heightRatio = +innerElement.getAttribute('heightratio');\n        return {\n          container: e,\n          innerElement: innerElement,\n          heightRatio: heightRatio\n        };\n      })\n    };\n  }, [g, items, revision, mutable.resizing]),\n      grid = _useMemo.grid,\n      rowHeight = _useMemo.rowHeight,\n      rowGap = _useMemo.rowGap,\n      gridItems = _useMemo.gridItems;\n\n  var resizeGridItem = React__default.useCallback(function (gi) {\n    var rect = gi.innerElement.getBoundingClientRect();\n\n    if (rect.width === 0) {\n      return;\n    }\n\n    var rowSpan;\n\n    if (gi.heightRatio) {\n      var impliedHeight = Math.round(rect.width * gi.heightRatio);\n      var heightWithGap = impliedHeight + rowGap;\n      var remainder = heightWithGap % (rowHeight + rowGap);\n      rowSpan = Math.round((heightWithGap - remainder) / (rowHeight + rowGap));\n    } else {\n      var _heightWithGap = rect.height + rowGap;\n\n      var _remainder = _heightWithGap % (rowHeight + rowGap);\n\n      rowSpan = Math.round((_heightWithGap - _remainder) / (rowHeight + rowGap));\n    }\n\n    gi.container.style.gridRowEnd = \"span \" + rowSpan;\n  }, [grid, items, gridItems, revision, mutable.resizing]);\n  var resizeAllGridItems = React__default.useCallback(function () {\n    gridItems.forEach(function (gi) {\n      return resizeGridItem(gi);\n    });\n  }, [grid, items, gridItems, revision, mutable.resizing, resizeGridItem]);\n  var handleResizeAllGridItems = React__default.useCallback(function () {\n    if (mutable.resizing) {\n      return;\n    }\n\n    mutable.resizing = true;\n    var timer = setTimeout(function () {\n      mutable.resizing = false;\n    }, 100);\n    window.requestAnimationFrame(function () {\n      clearTimeout(timer);\n      resizeAllGridItems();\n      mutable.resizing = false;\n    });\n  }, [grid, items, gridItems, revision, mutable.resizing, resizeAllGridItems]);\n  useEffect(function () {\n    window.addEventListener('resize', handleResizeAllGridItems);\n    return function () {\n      window.removeEventListener('resize', handleResizeAllGridItems);\n    };\n  }, [grid, items, gridItems, revision, mutable.resizing, handleResizeAllGridItems]);\n  useEffect(function () {\n    setTimeout(function () {\n      return handleResizeAllGridItems();\n    }, 100);\n  }, [grid, items, gridItems, revision, mutable.resizing, handleResizeAllGridItems]);\n  setTimeout(function () {\n    return handleResizeAllGridItems();\n  }, 0);\n  var inline$1 = useInlineStyle(function () {\n    var minval = min || '150px';\n    var maxval = max || '1.4fr';\n    return {\n      root: {\n        gridTemplateColumns: \"repeat(auto-fill, minmax(\" + minval + \",\" + maxval + \"))\",\n        '& .masonry-item': {\n          boxShadow: inline[\"switch\"](null, 'inherit', function () {\n            return theme.palette.type === 'light';\n          }, '2px 2px 4px #9c9c9c'),\n          borderRadius: 3,\n          overflow: 'hidden'\n        },\n        '& .masonry-item:hover': {\n          boxShadow: inline[\"switch\"](null, '3px 3px 6px #9c9c9c', function () {\n            return theme.palette.type === 'dark';\n          }, '0px 0px 4px #55555522')\n        }\n      }\n    };\n  }, [min, max])();\n  return /*#__PURE__*/React__default.createElement(\"div\", {\n    className: clsx('root', root.className, inline$1.root)\n  }, items.map(function (item, index) {\n    return elementForItem ? /*#__PURE__*/React__default.createElement(ElementContainer, _extends({\n      key: index\n    }, item, {\n      element: elementForItem(item, index)\n    })) : /*#__PURE__*/React__default.createElement(DefaultMasonryItem, _extends({\n      key: index\n    }, item));\n  }));\n};\n\nvar Transition = React__default.forwardRef(function Transition(props, ref) {\n  return /*#__PURE__*/React__default.createElement(Slide, _extends({\n    direction: \"down\",\n    ref: ref\n  }, props));\n});\n\nvar Modal = function Modal(props) {\n  var handleClose = function handleClose() {\n    return props.onClose();\n  };\n\n  var handleEscapeKey = function handleEscapeKey() {\n    return props.onEscape && props.onEscape();\n  };\n\n  var handleOk = function handleOk() {\n    props.onOk && props.onOk();\n    handleClose();\n  };\n\n  useEffect(function () {\n    document.addEventListener(\"keydown\", handleEscapeKey, false);\n    return function () {\n      return document.removeEventListener(\"keydown\", handleEscapeKey, false);\n    };\n  }, []);\n  return /*#__PURE__*/React__default.createElement(Dialog, {\n    open: props.show,\n    TransitionComponent: Transition,\n    onClose: handleClose,\n    disableBackdropClick: true,\n    disableEscapeKeyDown: true,\n    maxWidth: \"lg\"\n  }, /*#__PURE__*/React__default.createElement(div, {\n    relative: true\n  }, props.title, props.body), /*#__PURE__*/React__default.createElement(DialogActions, null, /*#__PURE__*/React__default.createElement(Button, {\n    onClick: handleClose,\n    color: \"default\"\n  }, props.onOk ? 'Cancel' : 'Close'), props.onOk && /*#__PURE__*/React__default.createElement(Button, {\n    onClick: handleOk,\n    color: \"default\"\n  }, \"OK\")));\n};\n\nvar isString = function isString(value) {\n  return typeof value === 'string';\n};\nvar isNumber = function isNumber(value) {\n  return typeof value === 'number';\n};\nvar isUndefined = function isUndefined(value) {\n  return typeof value === 'undefined';\n};\nvar isNull = function isNull(value) {\n  return value === null;\n};\nvar isNullOrUndefined$1 = function isNullOrUndefined(value) {\n  return isUndefined(value) || isNull(value);\n};\nvar isJsonPath = function isJsonPath(value) {\n  return isString(value) ? value.substring(0, 7) === 'json://' : false;\n};\n\nvar validation = {\n  __proto__: null,\n  isString: isString,\n  isNumber: isNumber,\n  isUndefined: isUndefined,\n  isNull: isNull,\n  isNullOrUndefined: isNullOrUndefined$1,\n  isJsonPath: isJsonPath\n};\n\nvar Throttle = /*#__PURE__*/function () {\n  function Throttle() {\n    this.lastKnownParams = null;\n    this.ticking = false;\n  }\n\n  var _proto = Throttle.prototype;\n\n  _proto.invokeWithAnimationFrame = function invokeWithAnimationFrame(method, params) {\n    var _this = this;\n\n    this.lastKnownParams = params;\n\n    if (!this.ticking) {\n      this.ticking = true;\n      window.requestAnimationFrame(function () {\n        method(_this.lastKnownParams);\n        _this.ticking = false;\n      });\n    }\n  };\n\n  return Throttle;\n}();\n\nfunction NumberInput(props) {\n  var throttleRef = useRef(new Throttle());\n  var throttle = throttleRef.current;\n  var inputRef = useRef(null);\n\n  var _React$useState = React__default.useState(props.value),\n      buffer = _React$useState[0],\n      setBuffer = _React$useState[1];\n\n  var constraints = {\n    min: !isNullOrUndefined$1(props.min) ? props.min : -999,\n    max: !isNullOrUndefined$1(props.max) ? props.max : 999,\n    step: props.step || 1,\n    precision: props.precision || 0\n  };\n\n  if (constraints.step) {\n    var parts = constraints.step.toString().split('.');\n\n    if (parts.length > 1) {\n      constraints.precision = parts[1].length;\n    }\n  }\n\n  if (props.unsigned && constraints.min < 0) constraints.min = 0;\n\n  var handleChange = function handleChange(value) {\n    var parsedValue = parseFloat(value);\n    if (parsedValue < constraints.min) parsedValue = constraints.min;\n    if (parsedValue > constraints.max) parsedValue = constraints.max;\n    var newValue = lib.math.roundDecimal(parsedValue, constraints.precision);\n    setBuffer(newValue);\n\n    if (props.onChange) {\n      throttle.invokeWithAnimationFrame(props.onChange, parsedValue);\n    }\n  };\n\n  var handleFocus = function handleFocus(e) {\n    inputRef.current.select();\n  };\n\n  var handleBlur = function handleBlur(e) {};\n\n  var context = _extends({\n    inputRef: inputRef,\n    handleChange: handleChange,\n    handleFocus: handleFocus,\n    handleBlur: handleBlur,\n    props: props,\n    value: buffer\n  }, constraints);\n\n  switch (props.variant) {\n    case 'slider':\n      return sliderInput(context);\n\n    default:\n      return inputWithUpDown(context);\n  }\n}\nfunction inputWithUpDown(context) {\n  var inputRef = context.inputRef,\n      handleChange = context.handleChange,\n      handleFocus = context.handleFocus,\n      handleBlur = context.handleBlur,\n      props = context.props,\n      value = context.value,\n      step = context.step;\n  return /*#__PURE__*/React__default.createElement(ui.Flex, {\n    row: true,\n    tight: true,\n    className: \"numeric-input-container\"\n  }, /*#__PURE__*/React__default.createElement(\"button\", {\n    className: \"numeric-spinner left\",\n    onClick: function onClick() {\n      return handleChange(value - step);\n    }\n  }, /*#__PURE__*/React__default.createElement(\"span\", null, \"-\")), /*#__PURE__*/React__default.createElement(\"input\", {\n    ref: inputRef,\n    className: \"numeric-input\",\n    type: \"number\",\n    inputMode: \"number\",\n    pattern: \"[0-9]*\",\n    onChange: function onChange(e) {\n      return handleChange(e.target.value);\n    },\n    onFocus: handleFocus,\n    onBlur: handleBlur,\n    value: value,\n    required: props.required,\n    placeholder: props.placeholder,\n    title: props.title\n  }), /*#__PURE__*/React__default.createElement(\"button\", {\n    className: \"numeric-spinner right\",\n    onClick: function onClick() {\n      return handleChange(value + step);\n    }\n  }, /*#__PURE__*/React__default.createElement(\"span\", null, \"+\")));\n}\nfunction sliderInput(context) {\n  var inputRef = context.inputRef,\n      handleChange = context.handleChange,\n      handleFocus = context.handleFocus,\n      handleBlur = context.handleBlur,\n      props = context.props,\n      value = context.value,\n      step = context.step,\n      min = context.min,\n      max = context.max;\n  var innerValue = value;\n  return /*#__PURE__*/React__default.createElement(ui.Flex, {\n    row: true,\n    tight: true,\n    alignItems: \"center\",\n    className: \"slider-input-container\"\n  }, /*#__PURE__*/React__default.createElement(\"input\", {\n    ref: inputRef,\n    className: \"slider\",\n    type: \"range\",\n    onChange: function onChange(e) {\n      return handleChange(e.target.value);\n    },\n    onFocus: handleFocus,\n    onBlur: handleBlur,\n    title: props.title,\n    value: innerValue,\n    min: min,\n    max: max,\n    step: step\n  }), /*#__PURE__*/React__default.createElement(ui.div, {\n    small: true,\n    marginLeft: 15\n  }, innerValue));\n}\n\nvar PanelProps = function PanelProps() {\n  this.sticky = false;\n  this.stickyTop = 0;\n};\n\nvar _ownProps = new PanelProps();\n\nvar Panel = function Panel(directives) {\n  var other = _extends({}, directives);\n\n  var _useStyleDirectives = useStyleDirectives(other, _ownProps, undefined, 'page-panel'),\n      root = _useStyleDirectives.root,\n      props = _useStyleDirectives.props,\n      data = _useStyleDirectives.data;\n\n  return /*#__PURE__*/React__default.createElement(col, _extends({\n    className: root.className\n  }, data, {\n    alignSelfStretch: true\n  }), /*#__PURE__*/React__default.createElement(div, {\n    relative: true,\n    alignSelfStart: true,\n    sticky: props.sticky,\n    top: props.sticky ? props.stickyTop : undefined\n  }, fnOrValue(props.children)));\n};\n\nvar ui$1 = _extends({}, divRowCol, hooks);\n\nvar PageProps = function PageProps() {};\n\nvar _ownProps$1 = new PageProps();\n\nvar Layout = function Layout(directives) {\n  var other = _extends({}, directives);\n\n  var _useStyleDirectives = useStyleDirectives(other, _ownProps$1),\n      root = _useStyleDirectives.root,\n      props = _useStyleDirectives.props,\n      data = _useStyleDirectives.data;\n\n  var style = useInlineStyle({\n    root: {\n      minHeight: '100vh;',\n      '& > .column': {\n        '& > .row': {\n          height: '100vh;',\n          '& > .page-panel': {\n            backgroundColor: '#80808011'\n          }\n        }\n      }\n    }\n  }, [])();\n  return /*#__PURE__*/React__default.createElement(ui$1.row, _extends({\n    className: \"page-layout \" + root.className + \" \" + style.root\n  }, data, {\n    tight: true\n  }), /*#__PURE__*/React__default.createElement(ui$1.col, {\n    wide: true\n  }, props.header && fnOrValue(props.header), /*#__PURE__*/React__default.createElement(ui$1.row, null, props.children)));\n};\nvar page = {\n  layout: Layout,\n  panel: Panel\n};\n\nvar PropertyPage = function PropertyPage(props) {\n  var data = props.data;\n  var keys = Object.keys(data).filter(function (key) {\n    return !!data[key] || data[key] === 0;\n  });\n  return /*#__PURE__*/React__default.createElement(Fragment, null, keys.map(function (key) {\n    var label = strutil.camelToSentenceCase(key);\n    return /*#__PURE__*/React__default.createElement(row, {\n      key: key,\n      spaced: true,\n      fontSize: \"0.8rem\"\n    }, /*#__PURE__*/React__default.createElement(div, {\n      width: \"50%\",\n      opacity: 0.5\n    }, label), /*#__PURE__*/React__default.createElement(div, {\n      width: \"50%\"\n    }, typeof data[key] === 'boolean' ? data[key].toString() : data[key]));\n  }));\n};\n\nvar _excluded$4 = [\"id\", \"onChange\", \"activeKey\", \"variant\", \"orientation\", \"centered\", \"items\", \"keyForItem\", \"elementForItem\"];\n\nfunction TabPanel(props) {\n  var children = props.children,\n      active = props.active,\n      value = props.value,\n      id = props.id;\n  return /*#__PURE__*/createElement(\"div\", {\n    role: \"tabpanel\",\n    hidden: !active,\n    id: id + \"-\" + value,\n    \"aria-labelledby\": id + \"-\" + value\n  }, children || /*#__PURE__*/createElement(\"div\", null, \"No content\"));\n}\n\nvar tabs = (function (directives) {\n  var onChange = directives.onChange,\n      activeKey = directives.activeKey,\n      items = directives.items,\n      keyForItem = directives.keyForItem,\n      elementForItem = directives.elementForItem,\n      d = _objectWithoutPropertiesLoose(directives, _excluded$4);\n\n  var _useStyleDirectives = useStyleDirectives(d, null, 'ui-tabs'),\n      root = _useStyleDirectives.root,\n      props = _useStyleDirectives.props;\n\n  var keys = items.map(function (item) {\n    if (!keyForItem) {\n      switch (typeof item) {\n        case 'string':\n          return item;\n\n        case 'number':\n          return item.toString();\n\n        default:\n          throw new Error('Invalid key');\n      }\n    }\n\n    return keyForItem(item);\n  });\n\n  var _React$useState = useState(function () {\n    return activeKey;\n  }),\n      selectedKey = _React$useState[0],\n      setActiveKey = _React$useState[1];\n\n  var handleChange = function handleChange(event, key) {\n    setActiveKey(key);\n    if (onChange) onChange(key);\n  };\n\n  var internalStyle = useInlineStyle(function () {\n    return {\n      minWidth: 'unset!important',\n      minHeight: 'unset!important'\n    };\n  }, [])();\n  if (!keys.length) return null;\n  var tabStrip = /*#__PURE__*/createElement(Tabs, {\n    orientation: directives.orientation,\n    value: selectedKey || keys[0],\n    onChange: handleChange,\n    \"aria-label\": \"tabs with \" + keys.length + \" panels\"\n  }, keys.map(function (key) {\n    var label = util.string.camelToSentenceCase(key);\n    return /*#__PURE__*/createElement(Tab, {\n      key: key,\n      label: label,\n      value: key\n    });\n  }));\n  var tabContent = items.map(function (item, index) {\n    var key = keys[index];\n    var isActiveTab = typeof selectedKey === 'undefined' && index === 0 || selectedKey === key;\n    return /*#__PURE__*/createElement(TabPanel, {\n      key: key,\n      active: isActiveTab,\n      value: key,\n      id: props.id || 'global'\n    }, elementForItem(item, isActiveTab));\n  });\n  var verticalLayout = /*#__PURE__*/createElement(row, {\n    wide: true\n  }, keys.length > 1 && /*#__PURE__*/createElement(col, null, tabStrip), /*#__PURE__*/createElement(col, {\n    grow: true\n  }, tabContent));\n  var horizontalLayout = /*#__PURE__*/createElement(Fragment$1, null, keys.length > 1 && tabStrip, tabContent);\n  var isVertical = directives.orientation === 'vertical';\n  return /*#__PURE__*/createElement(\"div\", {\n    className: clsx('root', root, internalStyle)\n  }, isVertical && verticalLayout, !isVertical && horizontalLayout);\n});\n\nvar _excluded$5 = [\"size\", \"children\"];\n\nvar Text = function Text(directives) {\n  var other = _objectWithoutPropertiesLoose(directives, _excluded$5);\n\n  var _useStyleDirectives = useStyleDirectives(other, null),\n      root = _useStyleDirectives.root,\n      data = _useStyleDirectives.data,\n      events = _useStyleDirectives.events;\n\n  if (!root.className) {\n    return fnOrValue(directives.children);\n  }\n\n  return /*#__PURE__*/React__default.createElement(\"div\", _extends({}, data, {\n    className: root.className\n  }, events), fnOrValue(directives.children));\n};\n\nvar index = _extends({}, divRowCol, {\n  card: MediaCard,\n  clsx: clsx,\n  counter: counter,\n  drawer: drawer,\n  dropdown: Dropdown\n}, hooks, {\n  loremIpsum: loremIpsum,\n  masonry: Masonry,\n  modal: Modal,\n  numberInput: NumberInput,\n  page: page,\n  propertyPage: PropertyPage,\n  table: Table,\n  tabs: tabs,\n  text: Text,\n  Throttle: Throttle,\n  useInlineStyle: useInlineStyle,\n  uuid: v4\n}, util, validation);\n\nexport default index;\nexport { useInlineStyle, useStyleDirectives };\n//# sourceMappingURL=index.modern.js.map\n","import React, {useState, useEffect, useRef, useMemo} from 'react';\r\nimport midiContext, { InternalMidiContextInterface, MidiMappedControl } from '../midiContext';\r\nimport ui from '@reactiff/ui-core';\r\nimport { MidiControl } from '../initialize/processMidiMessage';\r\nimport DeviceController from '../initialize/DeviceController';\r\nimport { useCallback } from 'react';\r\n\r\ntype Props = {\r\n    channel: number,\r\n    control: MidiControl,\r\n    controller: DeviceController,\r\n}\r\n\r\nfunction getControlId(props?: Props) {\r\n    if (!props) return undefined;\r\n    return `ch${props.channel}-${props.control.type}-${props.control.name}`;\r\n}\r\n\r\nexport default (props: Props) => {\r\n   \r\n    const controlId = getControlId(props);\r\n    const isActive = () => controlId === getControlId(props.controller.activeMapping);\r\n    const [revision, setRevision] = useState(0);\r\n    const rerender = useCallback(() => setRevision(r => r + 1), []);\r\n\r\n    const mappedControl: MidiMappedControl = { \r\n        ...props,\r\n        rerender,\r\n    };\r\n\r\n    // CALLBACKS //\r\n    const handleClick = () => {\r\n        if (!isActive()) {\r\n            props.controller.beginMapping(mappedControl);\r\n        }\r\n        else {\r\n            props.controller.cancelMapping();\r\n        }\r\n    }\r\n\r\n    // THESE FLAGS WILL DRIVE APPEARANCE\r\n    // Is this control mapped?\r\n    const mappedEvent = props.controller.getMappedEventData(controlId);\r\n    const mapped = !!mappedEvent;\r\n\r\n    // Is it Active now?\r\n    const active = isActive();\r\n\r\n\r\n    const cssBase: any = {\r\n        width: 60,\r\n        height: 60,\r\n        padding: 0,\r\n        borderRadius: '3px',\r\n        cursor: 'pointer',\r\n        backgroundColor: mapped ? '#16c793' : '#000000',\r\n    };\r\n    \r\n    const cssKnob: any = {\r\n        width: 58,\r\n        height: 58,\r\n        borderRadius: '3px',\r\n        borderColor: '#000',\r\n        backgroundColor: mapped ? '#08251c' : '#777777',\r\n        fontSize: \"0.55rem\",\r\n    };\r\n  \r\n    if (active) {\r\n        cssKnob.backgroundColor = mapped ? '#00ffff' : '#0055ff'\r\n        cssKnob.color = '#000'\r\n    }\r\n\r\n    return (\r\n        <ui.col alignCenter>\r\n            <ui.div className=\"center-xy\" css={cssBase} onClick={handleClick}>\r\n                <ui.div css={cssKnob} className=\"center-xy\">\r\n                    <span>{props.control.name}</span>\r\n                </ui.div>\r\n            </ui.div>\r\n        </ui.col>\r\n    );\r\n}","import React, {useState, useEffect, useRef, useMemo} from 'react';\r\nimport midiContext, { InternalMidiContextInterface, MidiMappedControl } from '../midiContext';\r\nimport ui from '@reactiff/ui-core';\r\nimport { MidiControl } from '../initialize/processMidiMessage';\r\nimport DeviceController from '../initialize/DeviceController';\r\nimport { useCallback } from 'react';\r\n\r\ntype Props = {\r\n    channel: number,\r\n    control: MidiControl,\r\n    controller: DeviceController,\r\n}\r\n\r\nfunction getControlId(props?: Props) {\r\n    if (!props) return undefined;\r\n    const group = props.control.group ? `${props.control.group}-` : '';\r\n    return `ch${props.channel}-${group}${props.control.type}-${props.control.name}`;\r\n}\r\n\r\nexport default (props: Props) => {\r\n\r\n    const controlId = getControlId(props);\r\n    const isActive = () => controlId === getControlId(props.controller.activeMapping);\r\n    const [revision, setRevision] = useState(0);\r\n    const rerender = useCallback(() => setRevision(r => r + 1), []);\r\n\r\n    const mappedControl: MidiMappedControl = { \r\n        ...props,\r\n        rerender,\r\n    };\r\n\r\n    // CALLBACKS //\r\n    const handleClick = () => {\r\n        if (!isActive()) {\r\n            props.controller.beginMapping(mappedControl);\r\n        }\r\n        else {\r\n            props.controller.cancelMapping();\r\n        }\r\n    }\r\n\r\n    // THESE FLAGS WILL DRIVE APPEARANCE\r\n    // Is this control mapped?\r\n    const mappedEvent = props.controller.getMappedEventData(controlId);\r\n    const mapped = !!mappedEvent;\r\n\r\n    // Is it Active now?\r\n    const active = isActive();\r\n\r\n    // STYLES //\r\n\r\n    // TODO transfer styles from .css file:\r\n    const cssBase: any = {\r\n        width: 60,\r\n        height: 60,\r\n        padding: 1,\r\n        borderRadius: '50%',\r\n        cursor: 'pointer',\r\n        backgroundColor: mapped ? '#16c793' : '#000000',\r\n    };\r\n    \r\n    const cssKnob: any= {\r\n        width: 58,\r\n        height: 58,\r\n        borderRadius: '50%',\r\n        borderColor: '#000',\r\n        backgroundColor: mapped ? '#08251c' : '#777777',\r\n        fontSize: \"0.55rem\",\r\n    };\r\n  \r\n    if (active) {\r\n        cssKnob.backgroundColor = mapped ? '#00ffff' : '#0055ff'\r\n        cssKnob.color = '#000';\r\n    }\r\n\r\n    return (\r\n        <ui.col alignCenter>\r\n            <ui.div className=\"center-xy\" css={cssBase} onClick={handleClick}>\r\n                <ui.div css={cssKnob} className=\"center-xy\">\r\n                    <span>{props.control.name}</span>\r\n                </ui.div>\r\n            </ui.div>\r\n        </ui.col>\r\n    );\r\n}","import React, { useCallback, useEffect } from 'react'\r\nimport midiContext from '../midiContext'\r\nimport ui from '@reactiff/ui-core'\r\n\r\nimport MIDIPad from './MIDIPad'\r\nimport MIDISelector from './MIDISelector'\r\n\r\nconst { range } = ui.logic\r\n\r\n//////////////////////////////////////////////////////////// MIDI SETTINGS\r\n\r\nconst MidiSettings = (props: any) => {\r\n  // HOOKS\r\n  const midi: any = React.useContext(midiContext)\r\n  const grid = ui.useGridSize('material')\r\n  // see https://www.npmjs.com/package/@reactiff/ui-core\r\n  \r\n  const dialogWidth = ui.logic.switch(\r\n    grid.value,\r\n    'calc(100% - 40px)', // default\r\n    (x) => x >= 3,\r\n    '800px',\r\n    (x) => x >= 2,\r\n    '700px'\r\n  )\r\n\r\n  // CALLBACKS //\r\n  const quitNow = useCallback(() => midi.toggleSettings(false), [])\r\n  const onEscapeKey = useCallback((e) => e.keyCode === 27 && quitNow(), [])\r\n\r\n  // EFFECTS //\r\n\r\n  useEffect(() => {\r\n    // Listen for Esc key\r\n    document.addEventListener('keydown', onEscapeKey, false)\r\n    return () => document.removeEventListener('keydown', onEscapeKey, false)\r\n  }, [])\r\n\r\n  // DYNAMIC STYLES //\r\n  const cssBG = React.useMemo(\r\n    () =>\r\n      ui.createStripes({\r\n        // bg\r\n        angle: 135,\r\n        colors: ['#00000088', '#00000099'],\r\n        size: 20\r\n      }),\r\n    []\r\n  )\r\n\r\n  const shadow = ui.useBoxShadow({ blur: 30, hex: '#00ff0022' }) // dialog\r\n  const cssDialog = {\r\n    boxShadow: shadow['box-shadow'],\r\n    backgroundColor: '#282c34',\r\n    border: '1px solid #88ff8833',\r\n    // width: dialogWidth,\r\n  }\r\n\r\n  if (!midi.settingsOpen) return null\r\n  if (midi.controllers.length === 0) return null // if not ready\r\n\r\n  const eventHandler = midi.getEventTarget()\r\n  const config = eventHandler.config;\r\n  const layout = config.layout || 'horizontal';\r\n  const horizontalInverted = layout === 'horizontal' && config.flowDirection === 'inverted';\r\n  const verticalInverted = layout === 'vertical' && config.flowDirection === 'inverted';\r\n\r\n  if (horizontalInverted) {\r\n    if (config.channelControls) config.channelControls.reverse();\r\n    if (config.globalGroups) config.globalGroups.forEach(g => g.reverse());\r\n  }\r\n  \r\n  if (verticalInverted) {\r\n    if (config.channelControls) config.channelControls.reverse();\r\n    if (config.globalGroups) config.globalGroups.forEach(g => g.reverse());\r\n  }\r\n  \r\n  return (\r\n    <ui.col fixed fill justifyCenter alignCenter css={cssBG}>\r\n      <ui.div relative css={cssDialog}>\r\n        {/* DIALOG HEADER */}\r\n        <ui.text fontSize='2em' color='white' bgColor='#111111dd' padding='15px 15px 5px 15px'>\r\n          MIDI mappings\r\n        </ui.text>\r\n\r\n        <ui.div padding=\"15px 15px 15px 15px\">\r\n          <ui.tabs\r\n            items={midi.controllers}\r\n            keyForItem={(controller) => {\r\n              if (!controller.device) debugger\r\n              return controller.device.name\r\n            }}\r\n            elementForItem={(controller, active) => {\r\n\r\n              const VerticalGlobals = config.globalGroups && layout === 'vertical' \r\n                ? () => (\r\n                  <ui.col marginTop={15} marginBottom={15}>\r\n                    {\r\n                      config.globalGroups.map((g, i) => {\r\n                        return <VerticalLayout key={i} scope={{ \r\n                          eventHandler, \r\n                          controller,\r\n                          channelNumbers: [0], \r\n                          channelControls: g  \r\n                        }}/>\r\n                      })\r\n                    }\r\n                  </ui.col>\r\n                ) : () => null;\r\n\r\n              const HorizontalGlobals = config.globalGroups && layout === 'horizontal' \r\n                ? () => (\r\n                  <ui.row marginLeft={15} marginRight={15}>\r\n\r\n                    {\r\n                      config.globalGroups.map((g, i) => {\r\n\r\n\r\n                        return <HorizontalLayout key={i} scope={{ \r\n                          eventHandler, \r\n                          controller,\r\n                          channelNumbers: [0], \r\n                          channelControls: g,  \r\n                        }}/>\r\n                      })\r\n                    }\r\n\r\n                    \r\n                  </ui.row>\r\n                ) : () => null;\r\n                \r\n              const channelNumbers = range(config.channels);\r\n\r\n              if (verticalInverted) {\r\n                channelNumbers.reverse();\r\n              }\r\n\r\n              return <ui.col>\r\n\r\n                <ui.text fontSize='0.7rem' color='white' padding='5px 0 30px 0' textAlign=\"right\">\r\n                  {controller.device.name}\r\n                </ui.text>\r\n                \r\n                {/* For vertical layout, render globals before the row */}\r\n\r\n                { !verticalInverted && <VerticalGlobals /> }\r\n                \r\n                <ui.row>\r\n                  \r\n                  { !horizontalInverted && <HorizontalGlobals /> }\r\n\r\n                  {\r\n                    layout === 'vertical' &&\r\n                    <VerticalLayout scope={{ \r\n                      eventHandler, \r\n                      controller,\r\n                      channelNumbers, \r\n                      channelControls: config.channelControls  \r\n                    }}/>\r\n                  }\r\n\r\n                  {\r\n                    layout === 'horizontal' &&\r\n                    <HorizontalLayout scope={{ \r\n                      eventHandler, \r\n                      controller, \r\n                      channelNumbers, \r\n                      channelControls: config.channelControls \r\n                    }}/>\r\n                  }\r\n\r\n                  { horizontalInverted && <HorizontalGlobals /> }\r\n\r\n                </ui.row>\r\n\r\n                { verticalInverted && <VerticalGlobals /> }\r\n                \r\n              </ui.col>\r\n            }}\r\n          />\r\n        </ui.div>\r\n      </ui.div>\r\n    </ui.col>\r\n  )\r\n}\r\n\r\nexport default MidiSettings\r\n\r\nconst VerticalLayout = (props: any) => {\r\n  const { scope } = props;\r\n  return (\r\n    <ui.col>\r\n      {\r\n        scope.channelNumbers.map((channel, index) => {\r\n          return (\r\n            <ui.row key={`ch${channel}`} spaced alignCenter padding=\"5px 0\">\r\n\r\n              <ui.div grow fontSize=\"0.875rem\">\r\n                {\r\n                  channel > 0 &&\r\n                  <span>CH {channel}</span>\r\n                }  \r\n              </ui.div>\r\n\r\n              {scope.channelControls.map((control, i) => {\r\n                return control.type === 'pad' ? (\r\n                  <MIDIPad\r\n                    key={i}\r\n                    channel={channel}\r\n                    control={control}\r\n                    controller={scope.controller}\r\n                  />\r\n                ) : (\r\n                  <MIDISelector\r\n                    key={i}\r\n                    channel={channel}\r\n                    control={control}\r\n                    controller={scope.controller}\r\n                  />\r\n                )\r\n              })}\r\n            </ui.row>\r\n          )\r\n        })\r\n      }\r\n    </ui.col>\r\n  )\r\n}\r\n\r\n\r\nconst HorizontalLayout = (props: any) => {\r\n  const { scope } = props;\r\n  return (\r\n    <ui.row>\r\n      {scope.channelNumbers.map((channel, index) => {\r\n        return (\r\n          \r\n          <ui.col key={`ch${channel}`} spaced alignCenter padding=\"0 5px\">\r\n\r\n            {scope.channelControls.map((control, i) => {\r\n              return control.type === 'pad' ? (\r\n                <MIDIPad\r\n                  key={i}\r\n                  channel={channel}\r\n                  control={control}\r\n                  controller={scope.controller}\r\n                />\r\n              ) : (\r\n                <MIDISelector\r\n                  key={i}\r\n                  channel={channel}\r\n                  control={control}\r\n                  controller={scope.controller}\r\n                />\r\n              )\r\n            })}\r\n\r\n            {\r\n              channel > 0 &&\r\n              <ui.div grow fontSize=\"0.875rem\">CH {channel}</ui.div>\r\n            }\r\n            \r\n          </ui.col>\r\n        )\r\n      })}\r\n    </ui.row>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport midiContext from './midiContext';\r\nimport ui from '@reactiff/ui-core';\r\n\r\n///////////////////////////////////////////// MIDI INDICATOR \r\n\r\nconst MidiIndicator = (props: any) => {\r\n    const midi: any = React.useContext(midiContext);\r\n\r\n    const style = { \r\n        cursor: 'pointer'\r\n    };\r\n\r\n    return <button onClick={() => midi.toggleSettings(true)}>\r\n        MIDI\r\n    </button>\r\n}\r\n\r\nexport default MidiIndicator;","import React, { useState, useEffect, useRef, useMemo, ReactNode } from 'react'\r\nimport midiContext, { InternalMidiContextInterface, MidiMappedControl } from './midiContext'\r\nimport { initialize } from './initialize'\r\nimport DeviceController from './initialize/DeviceController'\r\nimport { MidiEventTarget } from './initialize/processMidiMessage'\r\nimport Settings from './Settings';\r\n\r\n//////////////////////////////////////////////////////////////////////// MIDI\r\n\r\ntype MutableState = {\r\n  targetMap: { [index: string]: MidiEventTarget }\r\n  targetStack: MidiEventTarget[]\r\n}\r\n\r\nexport type MidiProps = {\r\n  children?: ReactNode\r\n}\r\nexport default (props: MidiProps) => {\r\n\r\n  const [controllers, setControllers]     = useState<DeviceController[]>([]);\r\n  const [settingsOpen, setSettingsOpen]   = useState(false);\r\n  \r\n  const mutable = useRef<MutableState>({\r\n    targetMap: {},\r\n    targetStack: []\r\n  }).current\r\n\r\n\r\n  // Should be called each time a) new device loads b) target registers/unregisters\r\n  const bindEventTargets = (cc: DeviceController[], tgt?: MidiEventTarget) => {\r\n    const _t = tgt || context.getEventTarget();\r\n    cc.forEach(c => c.bindEventTarget(_t));\r\n  } \r\n\r\n\r\n  const context: InternalMidiContextInterface = {\r\n\r\n    settingsOpen,\r\n    toggleSettings: (open: boolean) => {\r\n      setSettingsOpen(open);\r\n    },\r\n\r\n    controllers,\r\n    setControllers: (ctrls) => {\r\n      bindEventTargets(ctrls);\r\n      setControllers(ctrls);\r\n    },\r\n\r\n    getEventTarget() {\r\n      if (!mutable.targetStack.length) return undefined\r\n      return mutable.targetStack[mutable.targetStack.length - 1]\r\n    },\r\n\r\n    // PUBLIC INTERFACE\r\n    register(target: MidiEventTarget) {\r\n      if (mutable.targetMap[target.id]) {\r\n        throw new Error('Target already registered')\r\n      }\r\n      mutable.targetStack.push(target)\r\n      mutable.targetMap[target.id] = target\r\n      bindEventTargets(controllers, target);\r\n      return () => {\r\n        context.unregister(target);\r\n      };\r\n    },\r\n\r\n    unregister(target: MidiEventTarget) {\r\n      const top = context.getEventTarget()\r\n      if (!top) throw new Error('Nothing to pop')\r\n      if (top.id !== target.id) {\r\n        throw new Error('Target is not on top of the stack')\r\n      }\r\n      mutable.targetStack.pop()\r\n      delete mutable.targetMap[target.id]\r\n      bindEventTargets(controllers);\r\n    },\r\n\r\n  };\r\n\r\n  useEffect(() => {\r\n    initialize(context)\r\n    return () => {\r\n      controllers.forEach((d: any) => d.disconnect())\r\n    }\r\n  }, [])\r\n\r\n  return (\r\n    <midiContext.Provider value={context}>\r\n      {props.children}\r\n      <Settings />\r\n    </midiContext.Provider>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { MidiIndicator } from '@reactiff/midi';\r\n\r\nimport ui from '@reactiff/ui-core';\r\nimport { StripeOptionsType } from '@reactiff/ui-core/dist/hooks/stripes';\r\n\r\n/////////////////////////////////////////////////////////////////////// EXAMPLE - LAYOUT\r\n\r\nconst MidiControlledComponent = (props: any) => {\r\n\r\n    return <ui.col minHeight=\"100vh\">\r\n\r\n        <ui.div absolute top={30} left={30}>\r\n            <h1>MIDI</h1>\r\n            <p>\r\n                React library for interfacing with MIDI controllers\r\n            </p>\r\n            <a href=\"https://www.npmjs.com/package/@reactiff/midi\"><img src=\"https://img.shields.io/npm/v/@reactiff/midi.svg\" alt=\"NPM\"/></a>\r\n            <a href=\"https://standardjs.com\"><img src=\"https://img.shields.io/badge/code_style-standard-brightgreen.svg\" alt=\"JavaScript Style Guide\"/></a>\r\n            <br/>\r\n            MIT  <a href=\"https://github.com/reactiff\">Rick Ellis</a>\r\n        </ui.div>\r\n\r\n        <ui.row grow alignCenter justifyCenter>\r\n            {props.children}\r\n        </ui.row>\r\n        <ui.row padding={5}>\r\n            <ui.div grow />\r\n            <MidiIndicator />\r\n        </ui.row>\r\n    </ui.col>\r\n}\r\n\r\nexport default MidiControlledComponent;\r\n","import React, { useContext, useEffect, useState } from 'react'\r\nimport { midiContext, MidiIndicator } from '@reactiff/midi';\r\nimport { MidiEventTarget } from '../../dist/initialize/processMidiMessage';\r\nimport ui from '@reactiff/ui-core';\r\n\r\nfunction parseProperties(object: any) {\r\n    const properties = Object.entries(object).map(([key, value]) => {\r\n        const tokens: number[] = Object.values(value as any).map(v => v as number).slice(1);\r\n        const formatted = tokens.map((t, i) => {\r\n            switch(i) {\r\n                case 2:\r\n                    return t.toFixed(2);\r\n                default:\r\n                    return t;\r\n            }\r\n        });\r\n        const str = formatted.map(\r\n            (v: any, i: number) => {\r\n                const padded = v.toString().padStart(3, ' ')\r\n                return padded;\r\n            }\r\n        ).join(' ');\r\n        return { \r\n            key, \r\n            value: str,\r\n        }\r\n    });\r\n    return properties;\r\n}\r\n\r\nconst PropsTable = (props: any) => {\r\n    const properties = Object.entries(props.object).map(([key, value]) => ({key, value} as any));\r\n    return <>\r\n        {\r\n            properties.map((p, i) => {\r\n                return <ui.row key={i}>\r\n                    <ui.div width=\"50%\">{p.key}</ui.div>\r\n                    <ui.div width=\"50%\">{p.value}</ui.div>\r\n                </ui.row>\r\n            })\r\n        }\r\n    </>\r\n}\r\n\r\nexport default PropsTable;","import React, { useCallback, useContext, useEffect, useState, useMemo } from 'react'\r\nimport { midiContext, MidiIndicator } from '@reactiff/midi';\r\nimport { MidiEvent, MidiEventTargetConfiguration } from '@reactiff/midi/dist/initialize/processMidiMessage';\r\nimport Layout from './Layout';\r\nimport PropsTable from './PropsTable';\r\nimport ui from '@reactiff/ui-core';\r\n\r\nconst config: MidiEventTargetConfiguration = {\r\n    layout: \"horizontal\",\r\n    channels: 7,\r\n    channelControls: [\r\n        { type: 'selector', name: 'size' },\r\n        { type: 'selector', name: 'step' },\r\n        { type: 'pad', name: 'up' },\r\n        { type: 'pad', name: 'down' },\r\n    ],\r\n    globalGroups: [[\r\n        { type: 'selector', name: 'x' },\r\n        { type: 'selector', name: 'y' },\r\n        { type: 'pad', name: 'enter' },\r\n        { type: 'pad', name: 'exit' },\r\n    ]],\r\n    revision: 1,\r\n};\r\n\r\nconst createEventHandler = (scope: any) => () => {\r\n       \r\n    const onTouchStart      = (e: MidiEvent) => scope.setTouchState({...e});\r\n    const onAfterTouch      = (e: MidiEvent) => scope.setTouchState({...e});\r\n    const onTouchEnd        = (e: MidiEvent) => scope.setTouchState({...e});\r\n    const onParameterChange = (e: MidiEvent) => scope.updateParamState({...e});\r\n\r\n    const target = {\r\n        id: 'MidiControlledComponent',\r\n        config,\r\n        onTouchStart,\r\n        onAfterTouch,\r\n        onTouchEnd,\r\n        onParameterChange\r\n    };\r\n\r\n    scope.midi.register(target);\r\n\r\n    return () => scope.midi.unregister(target);\r\n};\r\n\r\n\r\nconst MidiControlledComponent = (props: any) => {\r\n\r\n    const midi = useContext(midiContext);\r\n    \r\n    const [touchState, setTouchState] = useState<any>({});\r\n    const [paramState, setParamState] = useState<any>({});\r\n    \r\n    const updateTouchState = useCallback((newState: any) => setTouchState(newState), []);\r\n    const updateParamState = useCallback((newState: any) => setParamState(newState), []);\r\n\r\n    const scope = {\r\n        midi,\r\n        touchState,\r\n        paramState,\r\n        setTouchState,\r\n        setParamState,\r\n        updateTouchState,\r\n        updateParamState,\r\n    };\r\n\r\n    useEffect(\r\n        useMemo(() => \r\n            createEventHandler(scope), []\r\n        ), []\r\n    );\r\n    \r\n    const keyCount = Object.keys(touchState).length + Object.keys(paramState).length;\r\n\r\n    return <Layout>\r\n        {\r\n            !keyCount && <h3>Touch your MIDI device's mapped controls to see stuff happening...</h3>\r\n        }\r\n\r\n        {\r\n            keyCount>0 &&\r\n            [touchState, paramState].map((item: any) => {\r\n\r\n                const hasKeys = Object.keys(item).length > 0;\r\n\r\n                return <ui.col width={260} fontSize=\"smaller\" border=\"1px solid #ffffff22\"  bgColor=\"#ffffff11\" padding={10} margin={5}>\r\n                    <h3>{item.handlerName}</h3>\r\n\r\n                    {\r\n                        hasKeys && \r\n                        <ui.div marginTop={10}>\r\n                            <PropsTable object={item} />\r\n                        </ui.div>\r\n                        \r\n                        \r\n                    }\r\n                    \r\n\r\n                    {\r\n                        !hasKeys && \r\n                        <ui.row justifyCenter alignCenter padding={15}>\r\n                            <strong>No data yet</strong>\r\n                        </ui.row>\r\n                    }\r\n                    \r\n                    \r\n                </ui.col>\r\n            })\r\n        }\r\n    </Layout>\r\n   \r\n}\r\n\r\nexport default MidiControlledComponent;\r\n","import React from 'react';\nimport Midi from '@reactiff/midi';\nimport MidiControlledComponent from './MidiControlledComponent';\n\nimport './css/index.css'\nimport './css/orthogonal.css'\nimport './css/flex.css'\n\nconst App = () => {\n    return <Midi>\n        <MidiControlledComponent />\n    </Midi>\n}\n\nexport default App;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}